2025-10-13 00:04:18.308 [http-nio-8080-exec-5] DEBUG org.springframework.security.web.FilterChainProxy - Securing GET /api/v1/itineraries
2025-10-13 00:04:18.318 [http-nio-8080-exec-5] DEBUG org.springframework.security.web.FilterChainProxy - Secured GET /api/v1/itineraries
2025-10-13 00:04:18.318 [http-nio-8080-exec-5] DEBUG org.springframework.web.servlet.DispatcherServlet - GET "/api/v1/itineraries", parameters={}
2025-10-13 00:04:18.318 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.tripplanner.controller.ItinerariesController#getAll(HttpServletRequest)
2025-10-13 00:04:18.320 [http-nio-8080-exec-5] INFO  com.tripplanner.controller.ItinerariesController - Getting all itineraries
2025-10-13 00:04:18.320 [http-nio-8080-exec-5] WARN  com.tripplanner.controller.ItinerariesController - User ID not found in request, using anonymous for development
2025-10-13 00:04:18.320 [http-nio-8080-exec-5] INFO  com.tripplanner.service.UserDataService - Fetching trip metadata for user: anonymous
2025-10-13 00:04:20.138 [http-nio-8080-exec-5] INFO  com.tripplanner.service.UserDataService - Found 6 trip metadata entries for user: anonymous
2025-10-13 00:04:20.139 [http-nio-8080-exec-5] INFO  com.tripplanner.controller.ItinerariesController - Found 6 itineraries for user: anonymous
2025-10-13 00:04:20.139 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.annotation.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-13 00:04:20.140 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.annotation.HttpEntityMethodProcessor - Writing [[ItineraryDto(id=it_105ebb3d-b1a7-491c-a811-1af7fff0ecf1, destination=Almaty, Kazakhstan, startDate= (truncated)...]
2025-10-13 00:04:20.141 [http-nio-8080-exec-5] DEBUG org.springframework.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-13 00:04:20.141 [http-nio-8080-exec-5] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-10-13 00:10:12.404 [SpringApplicationShutdownHook] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-10-13 00:10:12.590 [tomcat-shutdown] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-10-13 00:10:12.594 [SpringApplicationShutdownHook] DEBUG org.springframework.web.SimpLogging - clientOutboundChannel removed SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-10-13 00:10:12.595 [SpringApplicationShutdownHook] DEBUG org.springframework.web.SimpLogging - clientInboundChannel removed WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-10-13 00:10:12.595 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopping...
2025-10-13 00:10:12.595 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@7db2b614]]
2025-10-13 00:10:12.595 [SpringApplicationShutdownHook] DEBUG org.springframework.web.SimpLogging - clientInboundChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@7db2b614]
2025-10-13 00:10:12.595 [SpringApplicationShutdownHook] DEBUG org.springframework.web.SimpLogging - brokerChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@7db2b614]
2025-10-13 00:10:12.595 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopped.
2025-10-13 00:10:12.595 [SpringApplicationShutdownHook] DEBUG org.springframework.web.SimpLogging - clientInboundChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-10-13 00:10:12.596 [SpringApplicationShutdownHook] DEBUG org.springframework.web.SimpLogging - brokerChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-10-13 00:10:12.617 [SpringApplicationShutdownHook] INFO  com.tripplanner.service.GeminiClient - Gemini client cleanup completed
2025-10-13 00:10:12.617 [SpringApplicationShutdownHook] INFO  c.tripplanner.service.openrouter.OpenRouterClient - OpenRouter client cleanup completed
2025-10-13 00:10:26.349 [main] INFO  com.tripplanner.App - Starting App using Java 17.0.15 with PID 24100 (C:\Users\rites\Documents\AgenticItineraryPlanner\build\classes\java\main started by rites in C:\Users\rites\Documents\AgenticItineraryPlanner)
2025-10-13 00:10:26.353 [main] INFO  com.tripplanner.App - No active profile set, falling back to 1 default profile: "default"
2025-10-13 00:10:28.228 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-13 00:10:28.246 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-10-13 00:10:28.246 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-10-13 00:10:28.348 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-13 00:10:28.348 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1937 ms
2025-10-13 00:10:28.504 [main] INFO  com.tripplanner.config.FirestoreConfig - Firebase initialized for project: tripaiplanner-4c951
2025-10-13 00:10:28.574 [main] DEBUG o.springframework.web.filter.ForwardedHeaderFilter - Filter 'forwardedHeaderFilter' configured for use
2025-10-13 00:10:28.593 [main] INFO  com.tripplanner.config.AiClientConfig - === AI CLIENT CONFIGURATION ===
2025-10-13 00:10:28.593 [main] INFO  com.tripplanner.config.AiClientConfig - AI provider: gemini
2025-10-13 00:10:28.593 [main] INFO  com.tripplanner.config.AiClientConfig - OpenRouter API key configured: false
2025-10-13 00:10:28.593 [main] INFO  com.tripplanner.config.AiClientConfig - Gemini API key configured: false
2025-10-13 00:10:28.803 [main] INFO  c.tripplanner.service.openrouter.OpenRouterClient - Initialized OpenRouter client with model: qwen/qwen-2.5-72b-instruct:free  | apiKey=MISSING
2025-10-13 00:10:28.808 [main] INFO  com.tripplanner.service.GeminiClient - Initializing Gemini client with model: gemini-2.5-flash
2025-10-13 00:10:28.810 [main] INFO  com.tripplanner.service.GeminiClient - Gemini client initialized successfully with 150s request timeout
2025-10-13 00:10:28.810 [main] INFO  com.tripplanner.config.AiClientConfig - OpenRouter client available: false
2025-10-13 00:10:28.811 [main] INFO  com.tripplanner.config.AiClientConfig - Gemini client available: true
2025-10-13 00:10:28.811 [main] INFO  com.tripplanner.config.AiClientConfig - Creating ResilientAiClient with Gemini as primary, OpenRouter as fallback
2025-10-13 00:10:28.811 [main] INFO  com.tripplanner.config.AiClientConfig - Creating ResilientAiClient with 2 providers
2025-10-13 00:10:28.814 [main] INFO  com.tripplanner.service.ai.ResilientAiClient - ResilientAiClient initialized with 2 providers
2025-10-13 00:10:28.814 [main] INFO  com.tripplanner.service.ai.ResilientAiClient -   Provider 1: GeminiClient (available: true)
2025-10-13 00:10:28.814 [main] INFO  com.tripplanner.service.ai.ResilientAiClient -   Provider 2: OpenRouterClient (available: false)
2025-10-13 00:10:28.814 [main] INFO  com.tripplanner.config.AiClientConfig - ResilientAiClient created successfully
2025-10-13 00:10:28.884 [main] INFO  com.tripplanner.config.FirestoreConfig - Firestore project ID set to: tripaiplanner-4c951
2025-10-13 00:10:28.885 [main] INFO  com.tripplanner.config.FirestoreConfig - Configured Firestore credentials from firestore_credentials.json
2025-10-13 00:10:29.919 [main] INFO  com.tripplanner.config.FirestoreConfig - Firestore initialized for project: tripaiplanner-4c951 (emulator: false)
2025-10-13 00:10:30.060 [main] INFO  com.tripplanner.service.AgentRegistry - === AGENT REGISTRY INITIALIZATION ===
2025-10-13 00:10:30.060 [main] INFO  com.tripplanner.service.AgentRegistry - Found 12 agents to register
2025-10-13 00:10:30.061 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: activityagent -> ActivityAgent with capabilities: [populate_attractions]
2025-10-13 00:10:30.061 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: bookingagent -> BookingAgent with capabilities: [book]
2025-10-13 00:10:30.061 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: costestimatoragent -> CostEstimatorAgent with capabilities: [estimate_costs]
2025-10-13 00:10:30.061 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: daybydayplanneragent -> DayByDayPlannerAgent with capabilities: [plan]
2025-10-13 00:10:30.061 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: editoragent -> EditorAgent with capabilities: [edit]
2025-10-13 00:10:30.061 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: enrichmentagent -> EnrichmentAgent with capabilities: [enrich]
2025-10-13 00:10:30.061 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: explainagent -> ExplainAgent with capabilities: [explain]
2025-10-13 00:10:30.061 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: mealagent -> MealAgent with capabilities: [populate_meals]
2025-10-13 00:10:30.061 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: placesagent -> PlacesAgent with capabilities: [search]
2025-10-13 00:10:30.061 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: planneragent -> PlannerAgent with capabilities: [create]
2025-10-13 00:10:30.061 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: skeletonplanneragent -> SkeletonPlannerAgent with capabilities: [skeleton]
2025-10-13 00:10:30.061 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: transportagent -> TransportAgent with capabilities: [populate_transport]
2025-10-13 00:10:30.061 [main] INFO  com.tripplanner.service.AgentRegistry - Total registered agents: 12
2025-10-13 00:10:30.061 [main] INFO  com.tripplanner.service.AgentRegistry - =====================================
2025-10-13 00:10:30.070 [main] INFO  com.tripplanner.service.AiClientLLMProvider - Initialized AiClientLLMProvider with AI client: ResilientAiClient [Model: gemini-2.5-flash, Temperature: 0.70, Max Tokens: 65535, Provider: OpenRouter, Model: qwen/qwen-2.5-72b-instruct:free , Temperature: 0.70, Max Tokens: 8192]
2025-10-13 00:10:30.072 [main] INFO  com.tripplanner.service.GeminiLLMProvider - Initialized GeminiLLMProvider with AI client: ResilientAiClient [Model: gemini-2.5-flash, Temperature: 0.70, Max Tokens: 65535, Provider: OpenRouter, Model: qwen/qwen-2.5-72b-instruct:free , Temperature: 0.70, Max Tokens: 8192]
2025-10-13 00:10:30.072 [main] INFO  com.tripplanner.service.LLMService - Registered LLM provider: ai-client
2025-10-13 00:10:30.073 [main] INFO  com.tripplanner.service.LLMService - Registered LLM provider: gemini
2025-10-13 00:10:30.073 [main] INFO  com.tripplanner.service.LLMService - LLMService initialized with 2 providers
2025-10-13 00:10:30.098 [main] INFO  com.tripplanner.config.WebSocketConfig - === WEBSOCKET CONFIG: CREATING DEDICATED TASK EXECUTOR ===
2025-10-13 00:10:30.100 [main] INFO  com.tripplanner.config.WebSocketConfig - WebSocket TaskExecutor configured:
2025-10-13 00:10:30.100 [main] INFO  com.tripplanner.config.WebSocketConfig -   Core Pool Size: 2
2025-10-13 00:10:30.100 [main] INFO  com.tripplanner.config.WebSocketConfig -   Max Pool Size: 10
2025-10-13 00:10:30.100 [main] INFO  com.tripplanner.config.WebSocketConfig -   Queue Capacity: 50
2025-10-13 00:10:30.100 [main] INFO  com.tripplanner.config.WebSocketConfig -   Thread Name Prefix: WebSocket-
2025-10-13 00:10:30.112 [main] INFO  com.tripplanner.config.WebSocketConfig - === WEBSOCKET CONFIG: CONFIGURING MESSAGE BROKER ===
2025-10-13 00:10:30.113 [main] INFO  com.tripplanner.config.WebSocketConfig - Message broker configured successfully
2025-10-13 00:10:30.168 [main] INFO  com.tripplanner.service.TaskLifecycleManager - Initializing Task Lifecycle Manager
2025-10-13 00:10:33.151 [main] INFO  com.tripplanner.service.TaskLifecycleManager - Started monitoring 0 existing running tasks
2025-10-13 00:10:33.151 [main] INFO  com.tripplanner.service.TaskLifecycleManager - Task Lifecycle Manager initialized
2025-10-13 00:10:33.162 [main] INFO  com.tripplanner.config.AsyncConfig - === ASYNC CONFIG: CREATING PRIMARY TASK EXECUTOR ===
2025-10-13 00:10:33.162 [main] INFO  com.tripplanner.config.AsyncConfig - Primary TaskExecutor configured:
2025-10-13 00:10:33.163 [main] INFO  com.tripplanner.config.AsyncConfig -   Core Pool Size: 5
2025-10-13 00:10:33.163 [main] INFO  com.tripplanner.config.AsyncConfig -   Max Pool Size: 20
2025-10-13 00:10:33.163 [main] INFO  com.tripplanner.config.AsyncConfig -   Queue Capacity: 100
2025-10-13 00:10:33.163 [main] INFO  com.tripplanner.config.AsyncConfig -   Thread Name Prefix: AsyncTask-
2025-10-13 00:10:33.163 [main] INFO  com.tripplanner.config.AsyncConfig -   Keep Alive Seconds: 60
2025-10-13 00:10:33.242 [main] INFO  com.tripplanner.config.WebSocketConfig - === WEBSOCKET CONFIG: REGISTERING STOMP ENDPOINTS ===
2025-10-13 00:10:33.246 [main] INFO  com.tripplanner.config.WebSocketConfig - STOMP endpoints registered successfully
2025-10-13 00:10:33.273 [main] DEBUG o.s.w.s.server.support.WebSocketHandlerMapping - Patterns [/ws/**] in 'stompWebSocketHandlerMapping'
2025-10-13 00:10:33.377 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 45 mappings in 'requestMappingHandlerMapping'
2025-10-13 00:10:33.428 [main] DEBUG o.s.web.servlet.handler.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-13 00:10:33.462 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name inMemoryUserDetailsManager
2025-10-13 00:10:33.549 [main] DEBUG o.s.security.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-10-13 00:10:33.613 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.AgentController:
	
2025-10-13 00:10:33.613 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.ChatController:
	
2025-10-13 00:10:33.614 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.DocumentationController:
	
2025-10-13 00:10:33.614 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.HealthController:
	
2025-10-13 00:10:33.614 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.ItinerariesController:
	
2025-10-13 00:10:33.614 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.PingController:
	
2025-10-13 00:10:33.614 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.ToolsController:
	
2025-10-13 00:10:33.618 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.WebSocketController:
	{[MESSAGE],[/itinerary/{itineraryId}]}: handleItineraryUpdate(String,Map)
	{[MESSAGE],[/chat]}: handleChatMessage(Map)
	{[SUBSCRIBE],[/topic/itinerary/{itineraryId}]}: handleSubscription(String)
2025-10-13 00:10:33.620 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-10-13 00:10:33.679 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-13 00:10:33.725 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-13 00:10:33.885 [main] DEBUG org.springframework.web.SimpLogging - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-10-13 00:10:33.887 [main] DEBUG org.springframework.web.SimpLogging - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-10-13 00:10:33.887 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Starting...
2025-10-13 00:10:33.887 [main] DEBUG org.springframework.web.SimpLogging - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1be4a7e3]
2025-10-13 00:10:33.887 [main] DEBUG org.springframework.web.SimpLogging - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1be4a7e3]
2025-10-13 00:10:33.888 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1be4a7e3]]
2025-10-13 00:10:33.889 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Started.
2025-10-13 00:10:33.889 [main] DEBUG org.springframework.web.SimpLogging - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-10-13 00:10:33.889 [main] DEBUG org.springframework.web.SimpLogging - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-10-13 00:10:33.902 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-10-13 00:10:33.913 [main] INFO  com.tripplanner.App - Started App in 8.252 seconds (process running for 9.367)
2025-10-13 00:10:56.136 [http-nio-8080-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-13 00:10:56.136 [http-nio-8080-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-10-13 00:10:56.137 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-10-13 00:10:56.137 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-10-13 00:10:56.137 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-10-13 00:10:56.139 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@a80a896
2025-10-13 00:10:56.139 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@50d05167
2025-10-13 00:10:56.140 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-10-13 00:10:56.140 [http-nio-8080-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 4 ms
2025-10-13 00:10:56.180 [http-nio-8080-exec-1] DEBUG org.springframework.security.web.FilterChainProxy - Securing GET /api/v1/itineraries
2025-10-13 00:10:56.238 [http-nio-8080-exec-1] DEBUG org.springframework.security.web.FilterChainProxy - Secured GET /api/v1/itineraries
2025-10-13 00:10:56.244 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - GET "/api/v1/itineraries", parameters={}
2025-10-13 00:10:56.247 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.tripplanner.controller.ItinerariesController#getAll(HttpServletRequest)
2025-10-13 00:10:56.278 [http-nio-8080-exec-1] INFO  com.tripplanner.controller.ItinerariesController - Getting all itineraries
2025-10-13 00:10:56.278 [http-nio-8080-exec-1] WARN  com.tripplanner.controller.ItinerariesController - User ID not found in request, using anonymous for development
2025-10-13 00:10:56.278 [http-nio-8080-exec-1] INFO  com.tripplanner.service.UserDataService - Fetching trip metadata for user: anonymous
2025-10-13 00:10:57.158 [http-nio-8080-exec-1] INFO  com.tripplanner.service.UserDataService - Found 6 trip metadata entries for user: anonymous
2025-10-13 00:10:57.163 [http-nio-8080-exec-1] INFO  com.tripplanner.controller.ItinerariesController - Found 6 itineraries for user: anonymous
2025-10-13 00:10:57.234 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.annotation.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-13 00:10:57.253 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.annotation.HttpEntityMethodProcessor - Writing [[ItineraryDto(id=it_105ebb3d-b1a7-491c-a811-1af7fff0ecf1, destination=Almaty, Kazakhstan, startDate= (truncated)...]
2025-10-13 00:10:57.339 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-13 00:10:57.341 [http-nio-8080-exec-1] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-10-13 00:11:33.903 [MessageBroker-1] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-10-13 00:17:44.133 [http-nio-8080-exec-3] DEBUG org.springframework.security.web.FilterChainProxy - Securing GET /api/v1/itineraries
2025-10-13 00:17:44.137 [http-nio-8080-exec-3] DEBUG org.springframework.security.web.FilterChainProxy - Secured GET /api/v1/itineraries
2025-10-13 00:17:44.138 [http-nio-8080-exec-3] DEBUG org.springframework.web.servlet.DispatcherServlet - GET "/api/v1/itineraries", parameters={}
2025-10-13 00:17:44.139 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.tripplanner.controller.ItinerariesController#getAll(HttpServletRequest)
2025-10-13 00:17:44.141 [http-nio-8080-exec-3] INFO  com.tripplanner.controller.ItinerariesController - Getting all itineraries
2025-10-13 00:17:44.141 [http-nio-8080-exec-3] WARN  com.tripplanner.controller.ItinerariesController - User ID not found in request, using anonymous for development
2025-10-13 00:17:44.142 [http-nio-8080-exec-3] INFO  com.tripplanner.service.UserDataService - Fetching trip metadata for user: anonymous
2025-10-13 00:17:46.156 [http-nio-8080-exec-3] INFO  com.tripplanner.service.UserDataService - Found 6 trip metadata entries for user: anonymous
2025-10-13 00:17:46.158 [http-nio-8080-exec-3] INFO  com.tripplanner.controller.ItinerariesController - Found 6 itineraries for user: anonymous
2025-10-13 00:17:46.197 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.annotation.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-13 00:17:46.201 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.annotation.HttpEntityMethodProcessor - Writing [[ItineraryDto(id=it_105ebb3d-b1a7-491c-a811-1af7fff0ecf1, destination=Almaty, Kazakhstan, startDate= (truncated)...]
2025-10-13 00:17:46.207 [http-nio-8080-exec-3] DEBUG org.springframework.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-13 00:17:46.208 [http-nio-8080-exec-3] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-10-13 00:22:16.911 [http-nio-8080-exec-2] DEBUG org.springframework.security.web.FilterChainProxy - Securing GET /api/v1/itineraries
2025-10-13 00:22:16.915 [http-nio-8080-exec-2] DEBUG org.springframework.security.web.FilterChainProxy - Secured GET /api/v1/itineraries
2025-10-13 00:22:16.916 [http-nio-8080-exec-2] DEBUG org.springframework.web.servlet.DispatcherServlet - GET "/api/v1/itineraries", parameters={}
2025-10-13 00:22:16.917 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.tripplanner.controller.ItinerariesController#getAll(HttpServletRequest)
2025-10-13 00:22:16.919 [http-nio-8080-exec-2] INFO  com.tripplanner.controller.ItinerariesController - Getting all itineraries
2025-10-13 00:22:16.920 [http-nio-8080-exec-2] WARN  com.tripplanner.controller.ItinerariesController - User ID not found in request, using anonymous for development
2025-10-13 00:22:16.920 [http-nio-8080-exec-2] INFO  com.tripplanner.service.UserDataService - Fetching trip metadata for user: anonymous
2025-10-13 00:22:18.792 [http-nio-8080-exec-2] INFO  com.tripplanner.service.UserDataService - Found 6 trip metadata entries for user: anonymous
2025-10-13 00:22:18.794 [http-nio-8080-exec-2] INFO  com.tripplanner.controller.ItinerariesController - Found 6 itineraries for user: anonymous
2025-10-13 00:22:18.796 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.annotation.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-13 00:22:18.798 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.annotation.HttpEntityMethodProcessor - Writing [[ItineraryDto(id=it_105ebb3d-b1a7-491c-a811-1af7fff0ecf1, destination=Almaty, Kazakhstan, startDate= (truncated)...]
2025-10-13 00:22:18.804 [http-nio-8080-exec-2] DEBUG org.springframework.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-13 00:22:18.804 [http-nio-8080-exec-2] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-10-13 00:24:42.926 [SpringApplicationShutdownHook] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-10-13 00:24:43.187 [tomcat-shutdown] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-10-13 00:24:43.190 [SpringApplicationShutdownHook] DEBUG org.springframework.web.SimpLogging - clientOutboundChannel removed SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-10-13 00:24:43.190 [SpringApplicationShutdownHook] DEBUG org.springframework.web.SimpLogging - clientInboundChannel removed WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-10-13 00:24:43.190 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopping...
2025-10-13 00:24:43.190 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1be4a7e3]]
2025-10-13 00:24:43.190 [SpringApplicationShutdownHook] DEBUG org.springframework.web.SimpLogging - clientInboundChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1be4a7e3]
2025-10-13 00:24:43.191 [SpringApplicationShutdownHook] DEBUG org.springframework.web.SimpLogging - brokerChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1be4a7e3]
2025-10-13 00:24:43.191 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopped.
2025-10-13 00:24:43.191 [SpringApplicationShutdownHook] DEBUG org.springframework.web.SimpLogging - clientInboundChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-10-13 00:24:43.191 [SpringApplicationShutdownHook] DEBUG org.springframework.web.SimpLogging - brokerChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-10-13 00:24:43.216 [SpringApplicationShutdownHook] INFO  com.tripplanner.service.GeminiClient - Gemini client cleanup completed
2025-10-13 00:24:43.217 [SpringApplicationShutdownHook] INFO  c.tripplanner.service.openrouter.OpenRouterClient - OpenRouter client cleanup completed
2025-10-13 00:24:49.005 [main] INFO  com.tripplanner.App - Starting App using Java 17.0.15 with PID 13780 (C:\Users\rites\Documents\AgenticItineraryPlanner\build\classes\java\main started by rites in C:\Users\rites\Documents\AgenticItineraryPlanner)
2025-10-13 00:24:49.008 [main] INFO  com.tripplanner.App - No active profile set, falling back to 1 default profile: "default"
2025-10-13 00:24:50.635 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-13 00:24:50.652 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-10-13 00:24:50.652 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-10-13 00:24:50.739 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-13 00:24:50.739 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1665 ms
2025-10-13 00:24:50.832 [main] INFO  com.tripplanner.config.FirestoreConfig - Firebase initialized for project: tripaiplanner-4c951
2025-10-13 00:24:50.914 [main] DEBUG o.springframework.web.filter.ForwardedHeaderFilter - Filter 'forwardedHeaderFilter' configured for use
2025-10-13 00:24:50.937 [main] INFO  com.tripplanner.config.AiClientConfig - === AI CLIENT CONFIGURATION ===
2025-10-13 00:24:50.937 [main] INFO  com.tripplanner.config.AiClientConfig - AI provider: gemini
2025-10-13 00:24:50.937 [main] INFO  com.tripplanner.config.AiClientConfig - OpenRouter API key configured: false
2025-10-13 00:24:50.937 [main] INFO  com.tripplanner.config.AiClientConfig - Gemini API key configured: false
2025-10-13 00:24:51.098 [main] INFO  c.tripplanner.service.openrouter.OpenRouterClient - Initialized OpenRouter client with model: qwen/qwen-2.5-72b-instruct:free  | apiKey=MISSING
2025-10-13 00:24:51.102 [main] INFO  com.tripplanner.service.GeminiClient - Initializing Gemini client with model: gemini-2.5-flash
2025-10-13 00:24:51.104 [main] INFO  com.tripplanner.service.GeminiClient - Gemini client initialized successfully with 150s request timeout
2025-10-13 00:24:51.105 [main] INFO  com.tripplanner.config.AiClientConfig - OpenRouter client available: false
2025-10-13 00:24:51.106 [main] INFO  com.tripplanner.config.AiClientConfig - Gemini client available: true
2025-10-13 00:24:51.106 [main] INFO  com.tripplanner.config.AiClientConfig - Creating ResilientAiClient with Gemini as primary, OpenRouter as fallback
2025-10-13 00:24:51.106 [main] INFO  com.tripplanner.config.AiClientConfig - Creating ResilientAiClient with 2 providers
2025-10-13 00:24:51.108 [main] INFO  com.tripplanner.service.ai.ResilientAiClient - ResilientAiClient initialized with 2 providers
2025-10-13 00:24:51.108 [main] INFO  com.tripplanner.service.ai.ResilientAiClient -   Provider 1: GeminiClient (available: true)
2025-10-13 00:24:51.109 [main] INFO  com.tripplanner.service.ai.ResilientAiClient -   Provider 2: OpenRouterClient (available: false)
2025-10-13 00:24:51.109 [main] INFO  com.tripplanner.config.AiClientConfig - ResilientAiClient created successfully
2025-10-13 00:24:51.190 [main] INFO  com.tripplanner.config.FirestoreConfig - Firestore project ID set to: tripaiplanner-4c951
2025-10-13 00:24:51.191 [main] INFO  com.tripplanner.config.FirestoreConfig - Configured Firestore credentials from firestore_credentials.json
2025-10-13 00:24:52.106 [main] INFO  com.tripplanner.config.FirestoreConfig - Firestore initialized for project: tripaiplanner-4c951 (emulator: false)
2025-10-13 00:24:52.246 [main] INFO  com.tripplanner.service.AgentRegistry - === AGENT REGISTRY INITIALIZATION ===
2025-10-13 00:24:52.247 [main] INFO  com.tripplanner.service.AgentRegistry - Found 12 agents to register
2025-10-13 00:24:52.248 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: activityagent -> ActivityAgent with capabilities: [populate_attractions]
2025-10-13 00:24:52.248 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: bookingagent -> BookingAgent with capabilities: [book]
2025-10-13 00:24:52.248 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: costestimatoragent -> CostEstimatorAgent with capabilities: [estimate_costs]
2025-10-13 00:24:52.248 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: daybydayplanneragent -> DayByDayPlannerAgent with capabilities: [plan]
2025-10-13 00:24:52.248 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: editoragent -> EditorAgent with capabilities: [edit]
2025-10-13 00:24:52.249 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: enrichmentagent -> EnrichmentAgent with capabilities: [enrich]
2025-10-13 00:24:52.249 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: explainagent -> ExplainAgent with capabilities: [explain]
2025-10-13 00:24:52.249 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: mealagent -> MealAgent with capabilities: [populate_meals]
2025-10-13 00:24:52.249 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: placesagent -> PlacesAgent with capabilities: [search]
2025-10-13 00:24:52.249 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: planneragent -> PlannerAgent with capabilities: [create]
2025-10-13 00:24:52.249 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: skeletonplanneragent -> SkeletonPlannerAgent with capabilities: [skeleton]
2025-10-13 00:24:52.249 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: transportagent -> TransportAgent with capabilities: [populate_transport]
2025-10-13 00:24:52.249 [main] INFO  com.tripplanner.service.AgentRegistry - Total registered agents: 12
2025-10-13 00:24:52.249 [main] INFO  com.tripplanner.service.AgentRegistry - =====================================
2025-10-13 00:24:52.256 [main] INFO  com.tripplanner.service.AiClientLLMProvider - Initialized AiClientLLMProvider with AI client: ResilientAiClient [Model: gemini-2.5-flash, Temperature: 0.70, Max Tokens: 65535, Provider: OpenRouter, Model: qwen/qwen-2.5-72b-instruct:free , Temperature: 0.70, Max Tokens: 8192]
2025-10-13 00:24:52.257 [main] INFO  com.tripplanner.service.GeminiLLMProvider - Initialized GeminiLLMProvider with AI client: ResilientAiClient [Model: gemini-2.5-flash, Temperature: 0.70, Max Tokens: 65535, Provider: OpenRouter, Model: qwen/qwen-2.5-72b-instruct:free , Temperature: 0.70, Max Tokens: 8192]
2025-10-13 00:24:52.257 [main] INFO  com.tripplanner.service.LLMService - Registered LLM provider: ai-client
2025-10-13 00:24:52.258 [main] INFO  com.tripplanner.service.LLMService - Registered LLM provider: gemini
2025-10-13 00:24:52.258 [main] INFO  com.tripplanner.service.LLMService - LLMService initialized with 2 providers
2025-10-13 00:24:52.282 [main] INFO  com.tripplanner.config.WebSocketConfig - === WEBSOCKET CONFIG: CREATING DEDICATED TASK EXECUTOR ===
2025-10-13 00:24:52.285 [main] INFO  com.tripplanner.config.WebSocketConfig - WebSocket TaskExecutor configured:
2025-10-13 00:24:52.285 [main] INFO  com.tripplanner.config.WebSocketConfig -   Core Pool Size: 2
2025-10-13 00:24:52.285 [main] INFO  com.tripplanner.config.WebSocketConfig -   Max Pool Size: 10
2025-10-13 00:24:52.285 [main] INFO  com.tripplanner.config.WebSocketConfig -   Queue Capacity: 50
2025-10-13 00:24:52.285 [main] INFO  com.tripplanner.config.WebSocketConfig -   Thread Name Prefix: WebSocket-
2025-10-13 00:24:52.297 [main] INFO  com.tripplanner.config.WebSocketConfig - === WEBSOCKET CONFIG: CONFIGURING MESSAGE BROKER ===
2025-10-13 00:24:52.297 [main] INFO  com.tripplanner.config.WebSocketConfig - Message broker configured successfully
2025-10-13 00:24:52.349 [main] INFO  com.tripplanner.service.TaskLifecycleManager - Initializing Task Lifecycle Manager
2025-10-13 00:24:54.710 [main] INFO  com.tripplanner.service.TaskLifecycleManager - Started monitoring 0 existing running tasks
2025-10-13 00:24:54.710 [main] INFO  com.tripplanner.service.TaskLifecycleManager - Task Lifecycle Manager initialized
2025-10-13 00:24:54.721 [main] INFO  com.tripplanner.config.AsyncConfig - === ASYNC CONFIG: CREATING PRIMARY TASK EXECUTOR ===
2025-10-13 00:24:54.722 [main] INFO  com.tripplanner.config.AsyncConfig - Primary TaskExecutor configured:
2025-10-13 00:24:54.722 [main] INFO  com.tripplanner.config.AsyncConfig -   Core Pool Size: 5
2025-10-13 00:24:54.722 [main] INFO  com.tripplanner.config.AsyncConfig -   Max Pool Size: 20
2025-10-13 00:24:54.722 [main] INFO  com.tripplanner.config.AsyncConfig -   Queue Capacity: 100
2025-10-13 00:24:54.722 [main] INFO  com.tripplanner.config.AsyncConfig -   Thread Name Prefix: AsyncTask-
2025-10-13 00:24:54.722 [main] INFO  com.tripplanner.config.AsyncConfig -   Keep Alive Seconds: 60
2025-10-13 00:24:54.815 [main] INFO  com.tripplanner.config.WebSocketConfig - === WEBSOCKET CONFIG: REGISTERING STOMP ENDPOINTS ===
2025-10-13 00:24:54.820 [main] INFO  com.tripplanner.config.WebSocketConfig - STOMP endpoints registered successfully
2025-10-13 00:24:54.848 [main] DEBUG o.s.w.s.server.support.WebSocketHandlerMapping - Patterns [/ws/**] in 'stompWebSocketHandlerMapping'
2025-10-13 00:24:54.994 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 45 mappings in 'requestMappingHandlerMapping'
2025-10-13 00:24:55.043 [main] DEBUG o.s.web.servlet.handler.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-13 00:24:55.081 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name inMemoryUserDetailsManager
2025-10-13 00:24:55.185 [main] DEBUG o.s.security.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-10-13 00:24:55.258 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.AgentController:
	
2025-10-13 00:24:55.259 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.ChatController:
	
2025-10-13 00:24:55.259 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.DocumentationController:
	
2025-10-13 00:24:55.259 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.HealthController:
	
2025-10-13 00:24:55.259 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.ItinerariesController:
	
2025-10-13 00:24:55.259 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.PingController:
	
2025-10-13 00:24:55.259 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.ToolsController:
	
2025-10-13 00:24:55.264 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.WebSocketController:
	{[MESSAGE],[/itinerary/{itineraryId}]}: handleItineraryUpdate(String,Map)
	{[SUBSCRIBE],[/topic/itinerary/{itineraryId}]}: handleSubscription(String)
	{[MESSAGE],[/chat]}: handleChatMessage(Map)
2025-10-13 00:24:55.266 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-10-13 00:24:55.354 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-13 00:24:55.471 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-13 00:24:55.788 [main] DEBUG org.springframework.web.SimpLogging - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-10-13 00:24:55.789 [main] DEBUG org.springframework.web.SimpLogging - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-10-13 00:24:55.790 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Starting...
2025-10-13 00:24:55.790 [main] DEBUG org.springframework.web.SimpLogging - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5b430541]
2025-10-13 00:24:55.790 [main] DEBUG org.springframework.web.SimpLogging - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5b430541]
2025-10-13 00:24:55.791 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5b430541]]
2025-10-13 00:24:55.792 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Started.
2025-10-13 00:24:55.792 [main] DEBUG org.springframework.web.SimpLogging - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-10-13 00:24:55.792 [main] DEBUG org.springframework.web.SimpLogging - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-10-13 00:24:55.825 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-10-13 00:24:55.836 [main] INFO  com.tripplanner.App - Started App in 7.495 seconds (process running for 8.36)
2025-10-13 00:25:00.175 [http-nio-8080-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-13 00:25:00.175 [http-nio-8080-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-10-13 00:25:00.176 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-10-13 00:25:00.176 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-10-13 00:25:00.176 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-10-13 00:25:00.179 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@8167f57
2025-10-13 00:25:00.180 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@5cf33d25
2025-10-13 00:25:00.181 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-10-13 00:25:00.181 [http-nio-8080-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 6 ms
2025-10-13 00:25:00.227 [http-nio-8080-exec-1] DEBUG org.springframework.security.web.FilterChainProxy - Securing GET /api/v1/itineraries
2025-10-13 00:25:00.280 [http-nio-8080-exec-1] DEBUG org.springframework.security.web.FilterChainProxy - Secured GET /api/v1/itineraries
2025-10-13 00:25:00.285 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - GET "/api/v1/itineraries", parameters={}
2025-10-13 00:25:00.289 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.tripplanner.controller.ItinerariesController#getAll(HttpServletRequest)
2025-10-13 00:25:00.319 [http-nio-8080-exec-1] INFO  com.tripplanner.controller.ItinerariesController - Getting all itineraries
2025-10-13 00:25:00.319 [http-nio-8080-exec-1] WARN  com.tripplanner.controller.ItinerariesController - User ID not found in request, using anonymous for development
2025-10-13 00:25:00.319 [http-nio-8080-exec-1] INFO  com.tripplanner.service.UserDataService - Fetching trip metadata for user: anonymous
2025-10-13 00:25:01.091 [http-nio-8080-exec-1] INFO  com.tripplanner.service.UserDataService - Found 6 trip metadata entries for user: anonymous
2025-10-13 00:25:01.097 [http-nio-8080-exec-1] INFO  com.tripplanner.controller.ItinerariesController - Found 6 itineraries for user: anonymous
2025-10-13 00:25:01.187 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.annotation.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-13 00:25:01.207 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.annotation.HttpEntityMethodProcessor - Writing [[ItineraryDto(id=it_105ebb3d-b1a7-491c-a811-1af7fff0ecf1, destination=Almaty, Kazakhstan, startDate= (truncated)...]
2025-10-13 00:25:01.314 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-13 00:25:01.316 [http-nio-8080-exec-1] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-10-13 00:25:55.799 [MessageBroker-1] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-10-13 00:30:06.552 [SpringApplicationShutdownHook] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-10-13 00:30:06.765 [tomcat-shutdown] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-10-13 00:30:06.770 [SpringApplicationShutdownHook] DEBUG org.springframework.web.SimpLogging - clientOutboundChannel removed SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-10-13 00:30:06.770 [SpringApplicationShutdownHook] DEBUG org.springframework.web.SimpLogging - clientInboundChannel removed WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-10-13 00:30:06.770 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopping...
2025-10-13 00:30:06.771 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5b430541]]
2025-10-13 00:30:06.771 [SpringApplicationShutdownHook] DEBUG org.springframework.web.SimpLogging - clientInboundChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5b430541]
2025-10-13 00:30:06.771 [SpringApplicationShutdownHook] DEBUG org.springframework.web.SimpLogging - brokerChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5b430541]
2025-10-13 00:30:06.771 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopped.
2025-10-13 00:30:06.771 [SpringApplicationShutdownHook] DEBUG org.springframework.web.SimpLogging - clientInboundChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-10-13 00:30:06.772 [SpringApplicationShutdownHook] DEBUG org.springframework.web.SimpLogging - brokerChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-10-13 00:30:06.794 [SpringApplicationShutdownHook] INFO  com.tripplanner.service.GeminiClient - Gemini client cleanup completed
2025-10-13 00:30:06.794 [SpringApplicationShutdownHook] INFO  c.tripplanner.service.openrouter.OpenRouterClient - OpenRouter client cleanup completed
2025-10-13 00:32:09.717 [main] INFO  com.tripplanner.App - Starting App using Java 17.0.15 with PID 15668 (C:\Users\rites\Documents\AgenticItineraryPlanner\build\classes\java\main started by rites in C:\Users\rites\Documents\AgenticItineraryPlanner)
2025-10-13 00:32:09.720 [main] INFO  com.tripplanner.App - No active profile set, falling back to 1 default profile: "default"
2025-10-13 00:32:11.415 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-13 00:32:11.430 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-10-13 00:32:11.430 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-10-13 00:32:11.511 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-13 00:32:11.512 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1727 ms
2025-10-13 00:32:11.588 [main] INFO  com.tripplanner.config.FirestoreConfig - Firebase initialized for project: tripaiplanner-4c951
2025-10-13 00:32:11.666 [main] DEBUG o.springframework.web.filter.ForwardedHeaderFilter - Filter 'forwardedHeaderFilter' configured for use
2025-10-13 00:32:11.687 [main] INFO  com.tripplanner.config.AiClientConfig - === AI CLIENT CONFIGURATION ===
2025-10-13 00:32:11.687 [main] INFO  com.tripplanner.config.AiClientConfig - AI provider: gemini
2025-10-13 00:32:11.687 [main] INFO  com.tripplanner.config.AiClientConfig - OpenRouter API key configured: false
2025-10-13 00:32:11.687 [main] INFO  com.tripplanner.config.AiClientConfig - Gemini API key configured: false
2025-10-13 00:32:11.831 [main] INFO  c.tripplanner.service.openrouter.OpenRouterClient - Initialized OpenRouter client with model: qwen/qwen-2.5-72b-instruct:free  | apiKey=MISSING
2025-10-13 00:32:11.835 [main] INFO  com.tripplanner.service.GeminiClient - Initializing Gemini client with model: gemini-2.5-flash
2025-10-13 00:32:11.836 [main] INFO  com.tripplanner.service.GeminiClient - Gemini client initialized successfully with 150s request timeout
2025-10-13 00:32:11.837 [main] INFO  com.tripplanner.config.AiClientConfig - OpenRouter client available: false
2025-10-13 00:32:11.837 [main] INFO  com.tripplanner.config.AiClientConfig - Gemini client available: true
2025-10-13 00:32:11.837 [main] INFO  com.tripplanner.config.AiClientConfig - Creating ResilientAiClient with Gemini as primary, OpenRouter as fallback
2025-10-13 00:32:11.837 [main] INFO  com.tripplanner.config.AiClientConfig - Creating ResilientAiClient with 2 providers
2025-10-13 00:32:11.841 [main] INFO  com.tripplanner.service.ai.ResilientAiClient - ResilientAiClient initialized with 2 providers
2025-10-13 00:32:11.841 [main] INFO  com.tripplanner.service.ai.ResilientAiClient -   Provider 1: GeminiClient (available: true)
2025-10-13 00:32:11.841 [main] INFO  com.tripplanner.service.ai.ResilientAiClient -   Provider 2: OpenRouterClient (available: false)
2025-10-13 00:32:11.841 [main] INFO  com.tripplanner.config.AiClientConfig - ResilientAiClient created successfully
2025-10-13 00:32:11.922 [main] INFO  com.tripplanner.config.FirestoreConfig - Firestore project ID set to: tripaiplanner-4c951
2025-10-13 00:32:11.924 [main] INFO  com.tripplanner.config.FirestoreConfig - Configured Firestore credentials from firestore_credentials.json
2025-10-13 00:32:12.893 [main] INFO  com.tripplanner.config.FirestoreConfig - Firestore initialized for project: tripaiplanner-4c951 (emulator: false)
2025-10-13 00:32:13.044 [main] INFO  com.tripplanner.service.AgentRegistry - === AGENT REGISTRY INITIALIZATION ===
2025-10-13 00:32:13.044 [main] INFO  com.tripplanner.service.AgentRegistry - Found 12 agents to register
2025-10-13 00:32:13.045 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: activityagent -> ActivityAgent with capabilities: [populate_attractions]
2025-10-13 00:32:13.046 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: bookingagent -> BookingAgent with capabilities: [book]
2025-10-13 00:32:13.046 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: costestimatoragent -> CostEstimatorAgent with capabilities: [estimate_costs]
2025-10-13 00:32:13.046 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: daybydayplanneragent -> DayByDayPlannerAgent with capabilities: [plan]
2025-10-13 00:32:13.046 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: editoragent -> EditorAgent with capabilities: [edit]
2025-10-13 00:32:13.046 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: enrichmentagent -> EnrichmentAgent with capabilities: [enrich]
2025-10-13 00:32:13.047 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: explainagent -> ExplainAgent with capabilities: [explain]
2025-10-13 00:32:13.047 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: mealagent -> MealAgent with capabilities: [populate_meals]
2025-10-13 00:32:13.047 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: placesagent -> PlacesAgent with capabilities: [search]
2025-10-13 00:32:13.047 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: planneragent -> PlannerAgent with capabilities: [create]
2025-10-13 00:32:13.047 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: skeletonplanneragent -> SkeletonPlannerAgent with capabilities: [skeleton]
2025-10-13 00:32:13.047 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: transportagent -> TransportAgent with capabilities: [populate_transport]
2025-10-13 00:32:13.047 [main] INFO  com.tripplanner.service.AgentRegistry - Total registered agents: 12
2025-10-13 00:32:13.048 [main] INFO  com.tripplanner.service.AgentRegistry - =====================================
2025-10-13 00:32:13.056 [main] INFO  com.tripplanner.service.AiClientLLMProvider - Initialized AiClientLLMProvider with AI client: ResilientAiClient [Model: gemini-2.5-flash, Temperature: 0.70, Max Tokens: 65535, Provider: OpenRouter, Model: qwen/qwen-2.5-72b-instruct:free , Temperature: 0.70, Max Tokens: 8192]
2025-10-13 00:32:13.057 [main] INFO  com.tripplanner.service.GeminiLLMProvider - Initialized GeminiLLMProvider with AI client: ResilientAiClient [Model: gemini-2.5-flash, Temperature: 0.70, Max Tokens: 65535, Provider: OpenRouter, Model: qwen/qwen-2.5-72b-instruct:free , Temperature: 0.70, Max Tokens: 8192]
2025-10-13 00:32:13.059 [main] INFO  com.tripplanner.service.LLMService - Registered LLM provider: ai-client
2025-10-13 00:32:13.059 [main] INFO  com.tripplanner.service.LLMService - Registered LLM provider: gemini
2025-10-13 00:32:13.059 [main] INFO  com.tripplanner.service.LLMService - LLMService initialized with 2 providers
2025-10-13 00:32:13.088 [main] INFO  com.tripplanner.config.WebSocketConfig - === WEBSOCKET CONFIG: CREATING DEDICATED TASK EXECUTOR ===
2025-10-13 00:32:13.090 [main] INFO  com.tripplanner.config.WebSocketConfig - WebSocket TaskExecutor configured:
2025-10-13 00:32:13.090 [main] INFO  com.tripplanner.config.WebSocketConfig -   Core Pool Size: 2
2025-10-13 00:32:13.090 [main] INFO  com.tripplanner.config.WebSocketConfig -   Max Pool Size: 10
2025-10-13 00:32:13.090 [main] INFO  com.tripplanner.config.WebSocketConfig -   Queue Capacity: 50
2025-10-13 00:32:13.090 [main] INFO  com.tripplanner.config.WebSocketConfig -   Thread Name Prefix: WebSocket-
2025-10-13 00:32:13.105 [main] INFO  com.tripplanner.config.WebSocketConfig - === WEBSOCKET CONFIG: CONFIGURING MESSAGE BROKER ===
2025-10-13 00:32:13.106 [main] INFO  com.tripplanner.config.WebSocketConfig - Message broker configured successfully
2025-10-13 00:32:13.170 [main] INFO  com.tripplanner.service.TaskLifecycleManager - Initializing Task Lifecycle Manager
2025-10-13 00:32:15.770 [main] INFO  com.tripplanner.service.TaskLifecycleManager - Started monitoring 0 existing running tasks
2025-10-13 00:32:15.770 [main] INFO  com.tripplanner.service.TaskLifecycleManager - Task Lifecycle Manager initialized
2025-10-13 00:32:15.779 [main] INFO  com.tripplanner.config.AsyncConfig - === ASYNC CONFIG: CREATING PRIMARY TASK EXECUTOR ===
2025-10-13 00:32:15.779 [main] INFO  com.tripplanner.config.AsyncConfig - Primary TaskExecutor configured:
2025-10-13 00:32:15.779 [main] INFO  com.tripplanner.config.AsyncConfig -   Core Pool Size: 5
2025-10-13 00:32:15.779 [main] INFO  com.tripplanner.config.AsyncConfig -   Max Pool Size: 20
2025-10-13 00:32:15.779 [main] INFO  com.tripplanner.config.AsyncConfig -   Queue Capacity: 100
2025-10-13 00:32:15.779 [main] INFO  com.tripplanner.config.AsyncConfig -   Thread Name Prefix: AsyncTask-
2025-10-13 00:32:15.779 [main] INFO  com.tripplanner.config.AsyncConfig -   Keep Alive Seconds: 60
2025-10-13 00:32:15.863 [main] INFO  com.tripplanner.config.WebSocketConfig - === WEBSOCKET CONFIG: REGISTERING STOMP ENDPOINTS ===
2025-10-13 00:32:15.866 [main] INFO  com.tripplanner.config.WebSocketConfig - STOMP endpoints registered successfully
2025-10-13 00:32:15.890 [main] DEBUG o.s.w.s.server.support.WebSocketHandlerMapping - Patterns [/ws/**] in 'stompWebSocketHandlerMapping'
2025-10-13 00:32:15.989 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 45 mappings in 'requestMappingHandlerMapping'
2025-10-13 00:32:16.036 [main] DEBUG o.s.web.servlet.handler.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-13 00:32:16.070 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name inMemoryUserDetailsManager
2025-10-13 00:32:16.158 [main] DEBUG o.s.security.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-10-13 00:32:16.224 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.AgentController:
	
2025-10-13 00:32:16.224 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.ChatController:
	
2025-10-13 00:32:16.224 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.DocumentationController:
	
2025-10-13 00:32:16.224 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.HealthController:
	
2025-10-13 00:32:16.224 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.ItinerariesController:
	
2025-10-13 00:32:16.225 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.PingController:
	
2025-10-13 00:32:16.225 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.ToolsController:
	
2025-10-13 00:32:16.231 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.WebSocketController:
	{[MESSAGE],[/itinerary/{itineraryId}]}: handleItineraryUpdate(String,Map)
	{[SUBSCRIBE],[/topic/itinerary/{itineraryId}]}: handleSubscription(String)
	{[MESSAGE],[/chat]}: handleChatMessage(Map)
2025-10-13 00:32:16.232 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-10-13 00:32:16.299 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-13 00:32:16.345 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-13 00:32:16.492 [main] DEBUG org.springframework.web.SimpLogging - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-10-13 00:32:16.494 [main] DEBUG org.springframework.web.SimpLogging - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-10-13 00:32:16.495 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Starting...
2025-10-13 00:32:16.495 [main] DEBUG org.springframework.web.SimpLogging - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5b430541]
2025-10-13 00:32:16.496 [main] DEBUG org.springframework.web.SimpLogging - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5b430541]
2025-10-13 00:32:16.496 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5b430541]]
2025-10-13 00:32:16.497 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Started.
2025-10-13 00:32:16.498 [main] DEBUG org.springframework.web.SimpLogging - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-10-13 00:32:16.498 [main] DEBUG org.springframework.web.SimpLogging - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-10-13 00:32:16.511 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-10-13 00:32:16.519 [main] INFO  com.tripplanner.App - Started App in 7.485 seconds (process running for 8.333)
2025-10-13 00:32:26.783 [SpringApplicationShutdownHook] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-10-13 00:32:26.943 [tomcat-shutdown] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-10-13 00:32:26.945 [SpringApplicationShutdownHook] DEBUG org.springframework.web.SimpLogging - clientOutboundChannel removed SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-10-13 00:32:26.946 [SpringApplicationShutdownHook] DEBUG org.springframework.web.SimpLogging - clientInboundChannel removed WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-10-13 00:32:26.946 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopping...
2025-10-13 00:32:26.946 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5b430541]]
2025-10-13 00:32:26.946 [SpringApplicationShutdownHook] DEBUG org.springframework.web.SimpLogging - clientInboundChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5b430541]
2025-10-13 00:32:26.946 [SpringApplicationShutdownHook] DEBUG org.springframework.web.SimpLogging - brokerChannel removed SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5b430541]
2025-10-13 00:32:26.946 [SpringApplicationShutdownHook] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Stopped.
2025-10-13 00:32:26.946 [SpringApplicationShutdownHook] DEBUG org.springframework.web.SimpLogging - clientInboundChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-10-13 00:32:26.946 [SpringApplicationShutdownHook] DEBUG org.springframework.web.SimpLogging - brokerChannel removed UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-10-13 00:32:26.966 [SpringApplicationShutdownHook] INFO  com.tripplanner.service.GeminiClient - Gemini client cleanup completed
2025-10-13 00:32:26.966 [SpringApplicationShutdownHook] INFO  c.tripplanner.service.openrouter.OpenRouterClient - OpenRouter client cleanup completed
2025-10-13 00:32:37.061 [main] INFO  com.tripplanner.App - Starting App using Java 17.0.15 with PID 17688 (C:\Users\rites\Documents\AgenticItineraryPlanner\build\classes\java\main started by rites in C:\Users\rites\Documents\AgenticItineraryPlanner)
2025-10-13 00:32:37.064 [main] INFO  com.tripplanner.App - No active profile set, falling back to 1 default profile: "default"
2025-10-13 00:32:38.913 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-13 00:32:38.928 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-10-13 00:32:38.929 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-10-13 00:32:39.019 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-13 00:32:39.020 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1885 ms
2025-10-13 00:32:39.203 [main] ERROR com.tripplanner.config.FirestoreConfig - Failed to resolve Firestore credentials
java.io.IOException: Your default credentials were not found. To set up Application Default Credentials for your environment, see https://cloud.google.com/docs/authentication/external/set-up-adc.
	at com.google.auth.oauth2.DefaultCredentialsProvider.getDefaultCredentials(DefaultCredentialsProvider.java:127)
	at com.google.auth.oauth2.GoogleCredentials.getApplicationDefault(GoogleCredentials.java:129)
	at com.google.auth.oauth2.GoogleCredentials.getApplicationDefault(GoogleCredentials.java:101)
	at com.tripplanner.config.FirestoreConfig.resolveCredentials(FirestoreConfig.java:132)
	at com.tripplanner.config.FirestoreConfig.firebaseAuth(FirestoreConfig.java:100)
	at com.tripplanner.config.FirestoreConfig$$SpringCGLIB$$0.CGLIB$firebaseAuth$0(<generated>)
	at com.tripplanner.config.FirestoreConfig$$SpringCGLIB$$FastClass$$1.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invokeSuper(MethodProxy.java:258)
	at org.springframework.context.annotation.ConfigurationClassEnhancer$BeanMethodInterceptor.intercept(ConfigurationClassEnhancer.java:400)
	at com.tripplanner.config.FirestoreConfig$$SpringCGLIB$$0.firebaseAuth(<generated>)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.lambda$instantiate$0(SimpleInstantiationStrategy.java:172)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiateWithFactoryMethod(SimpleInstantiationStrategy.java:89)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:169)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:653)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:489)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1375)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1205)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:569)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1690)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1635)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:785)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:768)
	at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:146)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:509)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1459)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:606)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:413)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1375)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1205)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:569)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.getOrderedBeansOfType(ServletContextInitializerBeans.java:230)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.getOrderedBeansOfType(ServletContextInitializerBeans.java:221)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addServletContextInitializerBeans(ServletContextInitializerBeans.java:106)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.<init>(ServletContextInitializerBeans.java:95)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.getServletContextInitializerBeans(ServletWebServerApplicationContext.java:271)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.selfInitialize(ServletWebServerApplicationContext.java:245)
	at org.springframework.boot.web.embedded.tomcat.TomcatStarter.onStartup(TomcatStarter.java:52)
	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:4464)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1203)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1193)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:749)
	at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:772)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1203)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1193)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:749)
	at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:203)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.StandardService.startInternal(StandardService.java:412)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:870)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.startup.Tomcat.start(Tomcat.java:438)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.initialize(TomcatWebServer.java:128)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.<init>(TomcatWebServer.java:107)
	at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getTomcatWebServer(TomcatServletWebServerFactory.java:517)
	at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getWebServer(TomcatServletWebServerFactory.java:219)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.createWebServer(ServletWebServerApplicationContext.java:193)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:167)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:621)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.tripplanner.App.main(App.java:9)
2025-10-13 00:32:39.212 [main] ERROR com.tripplanner.config.FirestoreConfig - Failed to initialize Firebase Auth
java.lang.NullPointerException: FirebaseOptions must be initialized with setCredentials().
	at com.google.common.base.Preconditions.checkNotNull(Preconditions.java:921)
	at com.google.firebase.FirebaseOptions.<init>(FirebaseOptions.java:91)
	at com.google.firebase.FirebaseOptions.<init>(FirebaseOptions.java:43)
	at com.google.firebase.FirebaseOptions$Builder.build(FirebaseOptions.java:504)
	at com.tripplanner.config.FirestoreConfig.firebaseAuth(FirestoreConfig.java:105)
	at com.tripplanner.config.FirestoreConfig$$SpringCGLIB$$0.CGLIB$firebaseAuth$0(<generated>)
	at com.tripplanner.config.FirestoreConfig$$SpringCGLIB$$FastClass$$1.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invokeSuper(MethodProxy.java:258)
	at org.springframework.context.annotation.ConfigurationClassEnhancer$BeanMethodInterceptor.intercept(ConfigurationClassEnhancer.java:400)
	at com.tripplanner.config.FirestoreConfig$$SpringCGLIB$$0.firebaseAuth(<generated>)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.lambda$instantiate$0(SimpleInstantiationStrategy.java:172)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiateWithFactoryMethod(SimpleInstantiationStrategy.java:89)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:169)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:653)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:489)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1375)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1205)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:569)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1690)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1635)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:785)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:768)
	at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:146)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:509)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1459)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:606)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:413)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1375)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1205)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:569)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.getOrderedBeansOfType(ServletContextInitializerBeans.java:230)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.getOrderedBeansOfType(ServletContextInitializerBeans.java:221)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addServletContextInitializerBeans(ServletContextInitializerBeans.java:106)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.<init>(ServletContextInitializerBeans.java:95)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.getServletContextInitializerBeans(ServletWebServerApplicationContext.java:271)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.selfInitialize(ServletWebServerApplicationContext.java:245)
	at org.springframework.boot.web.embedded.tomcat.TomcatStarter.onStartup(TomcatStarter.java:52)
	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:4464)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1203)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1193)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:749)
	at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:772)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1203)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1193)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:749)
	at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:203)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.StandardService.startInternal(StandardService.java:412)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:870)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.startup.Tomcat.start(Tomcat.java:438)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.initialize(TomcatWebServer.java:128)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.<init>(TomcatWebServer.java:107)
	at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getTomcatWebServer(TomcatServletWebServerFactory.java:517)
	at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getWebServer(TomcatServletWebServerFactory.java:219)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.createWebServer(ServletWebServerApplicationContext.java:193)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:167)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:621)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.tripplanner.App.main(App.java:9)
2025-10-13 00:32:39.224 [main] ERROR o.s.boot.web.embedded.tomcat.TomcatStarter - Error starting Tomcat context. Exception: org.springframework.beans.factory.UnsatisfiedDependencyException. Message: Error creating bean with name 'firebaseAuthConfig': Unsatisfied dependency expressed through field 'firebaseAuth': Error creating bean with name 'firebaseAuth' defined in class path resource [com/tripplanner/config/FirestoreConfig.class]: Failed to instantiate [com.google.firebase.auth.FirebaseAuth]: Factory method 'firebaseAuth' threw exception with message: Failed to initialize Firebase Auth
2025-10-13 00:32:39.279 [main] INFO  org.apache.catalina.core.StandardService - Stopping service [Tomcat]
2025-10-13 00:32:39.287 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Unable to start web server
2025-10-13 00:32:39.300 [main] INFO  o.s.b.a.logging.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-10-13 00:32:39.334 [main] ERROR org.springframework.boot.SpringApplication - Application run failed
org.springframework.context.ApplicationContextException: Unable to start web server
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:170)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:621)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.tripplanner.App.main(App.java:9)
Caused by: org.springframework.boot.web.server.WebServerException: Unable to start embedded Tomcat
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.initialize(TomcatWebServer.java:147)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.<init>(TomcatWebServer.java:107)
	at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getTomcatWebServer(TomcatServletWebServerFactory.java:517)
	at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getWebServer(TomcatServletWebServerFactory.java:219)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.createWebServer(ServletWebServerApplicationContext.java:193)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:167)
	... 8 common frames omitted
Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'firebaseAuthConfig': Unsatisfied dependency expressed through field 'firebaseAuth': Error creating bean with name 'firebaseAuth' defined in class path resource [com/tripplanner/config/FirestoreConfig.class]: Failed to instantiate [com.google.firebase.auth.FirebaseAuth]: Factory method 'firebaseAuth' threw exception with message: Failed to initialize Firebase Auth
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:788)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:768)
	at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:146)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:509)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1459)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:606)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:413)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1375)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1205)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:569)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.getOrderedBeansOfType(ServletContextInitializerBeans.java:230)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.getOrderedBeansOfType(ServletContextInitializerBeans.java:221)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addServletContextInitializerBeans(ServletContextInitializerBeans.java:106)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.<init>(ServletContextInitializerBeans.java:95)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.getServletContextInitializerBeans(ServletWebServerApplicationContext.java:271)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.selfInitialize(ServletWebServerApplicationContext.java:245)
	at org.springframework.boot.web.embedded.tomcat.TomcatStarter.onStartup(TomcatStarter.java:52)
	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:4464)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1203)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1193)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:749)
	at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:772)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1203)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1193)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:749)
	at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:203)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.StandardService.startInternal(StandardService.java:412)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:870)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.startup.Tomcat.start(Tomcat.java:438)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.initialize(TomcatWebServer.java:128)
	... 13 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'firebaseAuth' defined in class path resource [com/tripplanner/config/FirestoreConfig.class]: Failed to instantiate [com.google.firebase.auth.FirebaseAuth]: Factory method 'firebaseAuth' threw exception with message: Failed to initialize Firebase Auth
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:657)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:489)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1375)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1205)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:569)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1690)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1635)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:785)
	... 63 common frames omitted
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.google.firebase.auth.FirebaseAuth]: Factory method 'firebaseAuth' threw exception with message: Failed to initialize Firebase Auth
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.lambda$instantiate$0(SimpleInstantiationStrategy.java:200)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiateWithFactoryMethod(SimpleInstantiationStrategy.java:89)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:169)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:653)
	... 75 common frames omitted
Caused by: java.lang.RuntimeException: Failed to initialize Firebase Auth
	at com.tripplanner.config.FirestoreConfig.firebaseAuth(FirestoreConfig.java:112)
	at com.tripplanner.config.FirestoreConfig$$SpringCGLIB$$0.CGLIB$firebaseAuth$0(<generated>)
	at com.tripplanner.config.FirestoreConfig$$SpringCGLIB$$FastClass$$1.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invokeSuper(MethodProxy.java:258)
	at org.springframework.context.annotation.ConfigurationClassEnhancer$BeanMethodInterceptor.intercept(ConfigurationClassEnhancer.java:400)
	at com.tripplanner.config.FirestoreConfig$$SpringCGLIB$$0.firebaseAuth(<generated>)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.lambda$instantiate$0(SimpleInstantiationStrategy.java:172)
	... 78 common frames omitted
Caused by: java.lang.NullPointerException: FirebaseOptions must be initialized with setCredentials().
	at com.google.common.base.Preconditions.checkNotNull(Preconditions.java:921)
	at com.google.firebase.FirebaseOptions.<init>(FirebaseOptions.java:91)
	at com.google.firebase.FirebaseOptions.<init>(FirebaseOptions.java:43)
	at com.google.firebase.FirebaseOptions$Builder.build(FirebaseOptions.java:504)
	at com.tripplanner.config.FirestoreConfig.firebaseAuth(FirestoreConfig.java:105)
	... 88 common frames omitted
2025-10-13 00:33:48.154 [main] INFO  com.tripplanner.App - Starting App using Java 17.0.15 with PID 22112 (C:\Users\rites\Documents\AgenticItineraryPlanner\build\classes\java\main started by rites in C:\Users\rites\Documents\AgenticItineraryPlanner)
2025-10-13 00:33:48.158 [main] INFO  com.tripplanner.App - No active profile set, falling back to 1 default profile: "default"
2025-10-13 00:33:50.152 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-13 00:33:50.168 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-10-13 00:33:50.170 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-10-13 00:33:50.267 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-13 00:33:50.267 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2038 ms
2025-10-13 00:33:50.350 [main] INFO  com.tripplanner.config.FirestoreConfig - Firebase initialized for project: tripaiplanner-4c951
2025-10-13 00:33:50.429 [main] DEBUG o.springframework.web.filter.ForwardedHeaderFilter - Filter 'forwardedHeaderFilter' configured for use
2025-10-13 00:33:50.450 [main] INFO  com.tripplanner.config.AiClientConfig - === AI CLIENT CONFIGURATION ===
2025-10-13 00:33:50.450 [main] INFO  com.tripplanner.config.AiClientConfig - AI provider: openrouter
2025-10-13 00:33:50.450 [main] INFO  com.tripplanner.config.AiClientConfig - OpenRouter API key configured: false
2025-10-13 00:33:50.450 [main] INFO  com.tripplanner.config.AiClientConfig - Gemini API key configured: false
2025-10-13 00:33:50.604 [main] INFO  c.tripplanner.service.openrouter.OpenRouterClient - Initialized OpenRouter client with model: qwen/qwen-2.5-72b-instruct:free  | apiKey=MISSING
2025-10-13 00:33:50.608 [main] INFO  com.tripplanner.service.GeminiClient - Initializing Gemini client with model: gemini-2.5-flash
2025-10-13 00:33:50.611 [main] INFO  com.tripplanner.service.GeminiClient - Gemini client initialized successfully with 150s request timeout
2025-10-13 00:33:50.612 [main] INFO  com.tripplanner.config.AiClientConfig - OpenRouter client available: false
2025-10-13 00:33:50.612 [main] INFO  com.tripplanner.config.AiClientConfig - Gemini client available: true
2025-10-13 00:33:50.612 [main] INFO  com.tripplanner.config.AiClientConfig - Creating ResilientAiClient with OpenRouter as primary, Gemini as fallback
2025-10-13 00:33:50.612 [main] INFO  com.tripplanner.config.AiClientConfig - Creating ResilientAiClient with 2 providers
2025-10-13 00:33:50.615 [main] INFO  com.tripplanner.service.ai.ResilientAiClient - ResilientAiClient initialized with 2 providers
2025-10-13 00:33:50.615 [main] INFO  com.tripplanner.service.ai.ResilientAiClient -   Provider 1: OpenRouterClient (available: false)
2025-10-13 00:33:50.615 [main] INFO  com.tripplanner.service.ai.ResilientAiClient -   Provider 2: GeminiClient (available: true)
2025-10-13 00:33:50.615 [main] INFO  com.tripplanner.config.AiClientConfig - ResilientAiClient created successfully
2025-10-13 00:33:50.725 [main] INFO  com.tripplanner.config.FirestoreConfig - Firestore project ID set to: tripaiplanner-4c951
2025-10-13 00:33:50.729 [main] INFO  com.tripplanner.config.FirestoreConfig - Configured Firestore credentials from firestore_credentials.json
2025-10-13 00:33:51.682 [main] INFO  com.tripplanner.config.FirestoreConfig - Firestore initialized for project: tripaiplanner-4c951 (emulator: false)
2025-10-13 00:33:51.826 [main] INFO  com.tripplanner.service.AgentRegistry - === AGENT REGISTRY INITIALIZATION ===
2025-10-13 00:33:51.826 [main] INFO  com.tripplanner.service.AgentRegistry - Found 12 agents to register
2025-10-13 00:33:51.827 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: activityagent -> ActivityAgent with capabilities: [populate_attractions]
2025-10-13 00:33:51.828 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: bookingagent -> BookingAgent with capabilities: [book]
2025-10-13 00:33:51.828 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: costestimatoragent -> CostEstimatorAgent with capabilities: [estimate_costs]
2025-10-13 00:33:51.828 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: daybydayplanneragent -> DayByDayPlannerAgent with capabilities: [plan]
2025-10-13 00:33:51.828 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: editoragent -> EditorAgent with capabilities: [edit]
2025-10-13 00:33:51.830 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: enrichmentagent -> EnrichmentAgent with capabilities: [enrich]
2025-10-13 00:33:51.830 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: explainagent -> ExplainAgent with capabilities: [explain]
2025-10-13 00:33:51.830 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: mealagent -> MealAgent with capabilities: [populate_meals]
2025-10-13 00:33:51.830 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: placesagent -> PlacesAgent with capabilities: [search]
2025-10-13 00:33:51.830 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: planneragent -> PlannerAgent with capabilities: [create]
2025-10-13 00:33:51.830 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: skeletonplanneragent -> SkeletonPlannerAgent with capabilities: [skeleton]
2025-10-13 00:33:51.830 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: transportagent -> TransportAgent with capabilities: [populate_transport]
2025-10-13 00:33:51.830 [main] INFO  com.tripplanner.service.AgentRegistry - Total registered agents: 12
2025-10-13 00:33:51.830 [main] INFO  com.tripplanner.service.AgentRegistry - =====================================
2025-10-13 00:33:51.839 [main] INFO  com.tripplanner.service.AiClientLLMProvider - Initialized AiClientLLMProvider with AI client: ResilientAiClient [Provider: OpenRouter, Model: qwen/qwen-2.5-72b-instruct:free , Temperature: 0.70, Max Tokens: 8192, Model: gemini-2.5-flash, Temperature: 0.70, Max Tokens: 65535]
2025-10-13 00:33:51.841 [main] INFO  com.tripplanner.service.GeminiLLMProvider - Initialized GeminiLLMProvider with AI client: ResilientAiClient [Provider: OpenRouter, Model: qwen/qwen-2.5-72b-instruct:free , Temperature: 0.70, Max Tokens: 8192, Model: gemini-2.5-flash, Temperature: 0.70, Max Tokens: 65535]
2025-10-13 00:33:51.842 [main] INFO  com.tripplanner.service.LLMService - Registered LLM provider: ai-client
2025-10-13 00:33:51.842 [main] INFO  com.tripplanner.service.LLMService - Registered LLM provider: gemini
2025-10-13 00:33:51.842 [main] INFO  com.tripplanner.service.LLMService - LLMService initialized with 2 providers
2025-10-13 00:33:51.869 [main] INFO  com.tripplanner.config.WebSocketConfig - === WEBSOCKET CONFIG: CREATING DEDICATED TASK EXECUTOR ===
2025-10-13 00:33:51.872 [main] INFO  com.tripplanner.config.WebSocketConfig - WebSocket TaskExecutor configured:
2025-10-13 00:33:51.872 [main] INFO  com.tripplanner.config.WebSocketConfig -   Core Pool Size: 2
2025-10-13 00:33:51.872 [main] INFO  com.tripplanner.config.WebSocketConfig -   Max Pool Size: 10
2025-10-13 00:33:51.872 [main] INFO  com.tripplanner.config.WebSocketConfig -   Queue Capacity: 50
2025-10-13 00:33:51.872 [main] INFO  com.tripplanner.config.WebSocketConfig -   Thread Name Prefix: WebSocket-
2025-10-13 00:33:51.885 [main] INFO  com.tripplanner.config.WebSocketConfig - === WEBSOCKET CONFIG: CONFIGURING MESSAGE BROKER ===
2025-10-13 00:33:51.886 [main] INFO  com.tripplanner.config.WebSocketConfig - Message broker configured successfully
2025-10-13 00:33:51.941 [main] INFO  com.tripplanner.service.TaskLifecycleManager - Initializing Task Lifecycle Manager
2025-10-13 00:33:54.615 [main] INFO  com.tripplanner.service.TaskLifecycleManager - Started monitoring 0 existing running tasks
2025-10-13 00:33:54.615 [main] INFO  com.tripplanner.service.TaskLifecycleManager - Task Lifecycle Manager initialized
2025-10-13 00:33:54.628 [main] INFO  com.tripplanner.config.AsyncConfig - === ASYNC CONFIG: CREATING PRIMARY TASK EXECUTOR ===
2025-10-13 00:33:54.628 [main] INFO  com.tripplanner.config.AsyncConfig - Primary TaskExecutor configured:
2025-10-13 00:33:54.629 [main] INFO  com.tripplanner.config.AsyncConfig -   Core Pool Size: 5
2025-10-13 00:33:54.629 [main] INFO  com.tripplanner.config.AsyncConfig -   Max Pool Size: 20
2025-10-13 00:33:54.629 [main] INFO  com.tripplanner.config.AsyncConfig -   Queue Capacity: 100
2025-10-13 00:33:54.629 [main] INFO  com.tripplanner.config.AsyncConfig -   Thread Name Prefix: AsyncTask-
2025-10-13 00:33:54.629 [main] INFO  com.tripplanner.config.AsyncConfig -   Keep Alive Seconds: 60
2025-10-13 00:33:54.752 [main] INFO  com.tripplanner.config.WebSocketConfig - === WEBSOCKET CONFIG: REGISTERING STOMP ENDPOINTS ===
2025-10-13 00:33:54.758 [main] INFO  com.tripplanner.config.WebSocketConfig - STOMP endpoints registered successfully
2025-10-13 00:33:54.800 [main] DEBUG o.s.w.s.server.support.WebSocketHandlerMapping - Patterns [/ws/**] in 'stompWebSocketHandlerMapping'
2025-10-13 00:33:54.988 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 45 mappings in 'requestMappingHandlerMapping'
2025-10-13 00:33:55.071 [main] DEBUG o.s.web.servlet.handler.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-13 00:33:55.132 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name inMemoryUserDetailsManager
2025-10-13 00:33:55.328 [main] DEBUG o.s.security.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-10-13 00:33:55.433 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.AgentController:
	
2025-10-13 00:33:55.433 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.ChatController:
	
2025-10-13 00:33:55.434 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.DocumentationController:
	
2025-10-13 00:33:55.434 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.HealthController:
	
2025-10-13 00:33:55.434 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.ItinerariesController:
	
2025-10-13 00:33:55.434 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.PingController:
	
2025-10-13 00:33:55.434 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.ToolsController:
	
2025-10-13 00:33:55.441 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.WebSocketController:
	{[MESSAGE],[/itinerary/{itineraryId}]}: handleItineraryUpdate(String,Map)
	{[MESSAGE],[/chat]}: handleChatMessage(Map)
	{[SUBSCRIBE],[/topic/itinerary/{itineraryId}]}: handleSubscription(String)
2025-10-13 00:33:55.443 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-10-13 00:33:55.547 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-13 00:33:55.602 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-13 00:33:55.731 [main] DEBUG org.springframework.web.SimpLogging - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-10-13 00:33:55.731 [main] DEBUG org.springframework.web.SimpLogging - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-10-13 00:33:55.732 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Starting...
2025-10-13 00:33:55.732 [main] DEBUG org.springframework.web.SimpLogging - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@73d7d676]
2025-10-13 00:33:55.732 [main] DEBUG org.springframework.web.SimpLogging - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@73d7d676]
2025-10-13 00:33:55.733 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@73d7d676]]
2025-10-13 00:33:55.733 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Started.
2025-10-13 00:33:55.735 [main] DEBUG org.springframework.web.SimpLogging - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-10-13 00:33:55.735 [main] DEBUG org.springframework.web.SimpLogging - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-10-13 00:33:55.750 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-10-13 00:33:55.759 [main] INFO  com.tripplanner.App - Started App in 8.425 seconds (process running for 9.153)
2025-10-13 00:34:54.974 [http-nio-8080-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-13 00:34:54.975 [http-nio-8080-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-10-13 00:34:54.976 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-10-13 00:34:54.976 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-10-13 00:34:54.977 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-10-13 00:34:54.979 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@6843fdc4
2025-10-13 00:34:54.980 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@59b1edab
2025-10-13 00:34:54.981 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-10-13 00:34:54.981 [http-nio-8080-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 6 ms
2025-10-13 00:34:55.030 [http-nio-8080-exec-1] DEBUG org.springframework.security.web.FilterChainProxy - Securing GET /api/v1/itineraries
2025-10-13 00:34:55.098 [http-nio-8080-exec-1] DEBUG org.springframework.security.web.FilterChainProxy - Secured GET /api/v1/itineraries
2025-10-13 00:34:55.103 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - GET "/api/v1/itineraries", parameters={}
2025-10-13 00:34:55.107 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.tripplanner.controller.ItinerariesController#getAll(HttpServletRequest)
2025-10-13 00:34:55.137 [http-nio-8080-exec-1] INFO  com.tripplanner.controller.ItinerariesController - Getting all itineraries
2025-10-13 00:34:55.138 [http-nio-8080-exec-1] WARN  com.tripplanner.controller.ItinerariesController - User ID not found in request, using anonymous for development
2025-10-13 00:34:55.138 [http-nio-8080-exec-1] INFO  com.tripplanner.service.UserDataService - Fetching trip metadata for user: anonymous
2025-10-13 00:34:55.749 [MessageBroker-1] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-10-13 00:34:55.896 [http-nio-8080-exec-1] INFO  com.tripplanner.service.UserDataService - Found 6 trip metadata entries for user: anonymous
2025-10-13 00:34:55.900 [http-nio-8080-exec-1] INFO  com.tripplanner.controller.ItinerariesController - Found 6 itineraries for user: anonymous
2025-10-13 00:34:55.976 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.annotation.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-13 00:34:56.003 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.annotation.HttpEntityMethodProcessor - Writing [[ItineraryDto(id=it_105ebb3d-b1a7-491c-a811-1af7fff0ecf1, destination=Almaty, Kazakhstan, startDate= (truncated)...]
2025-10-13 00:34:56.104 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-13 00:34:56.106 [http-nio-8080-exec-1] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-10-13 06:30:12.081 [main] INFO  com.tripplanner.App - Starting App using Java 17.0.15 with PID 19784 (C:\Users\rites\Documents\AgenticItineraryPlanner\build\classes\java\main started by rites in C:\Users\rites\Documents\AgenticItineraryPlanner)
2025-10-13 06:30:12.087 [main] INFO  com.tripplanner.App - No active profile set, falling back to 1 default profile: "default"
2025-10-13 06:30:15.609 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-13 06:30:15.666 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-10-13 06:30:15.669 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-10-13 06:30:15.982 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-13 06:30:15.984 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 3793 ms
2025-10-13 06:30:16.301 [main] INFO  com.tripplanner.config.FirestoreConfig - Firebase initialized for project: tripaiplanner-4c951
2025-10-13 06:30:16.483 [main] DEBUG o.springframework.web.filter.ForwardedHeaderFilter - Filter 'forwardedHeaderFilter' configured for use
2025-10-13 06:30:16.508 [main] INFO  com.tripplanner.config.AiClientConfig - === AI CLIENT CONFIGURATION ===
2025-10-13 06:30:16.510 [main] INFO  com.tripplanner.config.AiClientConfig - AI provider: openrouter
2025-10-13 06:30:16.510 [main] INFO  com.tripplanner.config.AiClientConfig - OpenRouter API key configured: false
2025-10-13 06:30:16.510 [main] INFO  com.tripplanner.config.AiClientConfig - Gemini API key configured: false
2025-10-13 06:30:16.883 [main] INFO  c.tripplanner.service.openrouter.OpenRouterClient - Initialized OpenRouter client with model: qwen/qwen-2.5-72b-instruct:free  | apiKey=MISSING
2025-10-13 06:30:16.890 [main] INFO  com.tripplanner.service.GeminiClient - Initializing Gemini client with model: gemini-2.5-flash
2025-10-13 06:30:16.894 [main] INFO  com.tripplanner.service.GeminiClient - Gemini client initialized successfully with 150s request timeout
2025-10-13 06:30:16.895 [main] INFO  com.tripplanner.config.AiClientConfig - OpenRouter client available: false
2025-10-13 06:30:16.895 [main] INFO  com.tripplanner.config.AiClientConfig - Gemini client available: true
2025-10-13 06:30:16.895 [main] INFO  com.tripplanner.config.AiClientConfig - Creating ResilientAiClient with OpenRouter as primary, Gemini as fallback
2025-10-13 06:30:16.896 [main] INFO  com.tripplanner.config.AiClientConfig - Creating ResilientAiClient with 2 providers
2025-10-13 06:30:16.902 [main] INFO  com.tripplanner.service.ai.ResilientAiClient - ResilientAiClient initialized with 2 providers
2025-10-13 06:30:16.903 [main] INFO  com.tripplanner.service.ai.ResilientAiClient -   Provider 1: OpenRouterClient (available: false)
2025-10-13 06:30:16.904 [main] INFO  com.tripplanner.service.ai.ResilientAiClient -   Provider 2: GeminiClient (available: true)
2025-10-13 06:30:16.904 [main] INFO  com.tripplanner.config.AiClientConfig - ResilientAiClient created successfully
2025-10-13 06:30:17.077 [main] INFO  com.tripplanner.config.FirestoreConfig - Firestore project ID set to: tripaiplanner-4c951
2025-10-13 06:30:17.082 [main] INFO  com.tripplanner.config.FirestoreConfig - Configured Firestore credentials from firestore_credentials.json
2025-10-13 06:30:18.870 [main] INFO  com.tripplanner.config.FirestoreConfig - Firestore initialized for project: tripaiplanner-4c951 (emulator: false)
2025-10-13 06:30:19.184 [main] INFO  com.tripplanner.service.AgentRegistry - === AGENT REGISTRY INITIALIZATION ===
2025-10-13 06:30:19.185 [main] INFO  com.tripplanner.service.AgentRegistry - Found 12 agents to register
2025-10-13 06:30:19.187 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: activityagent -> ActivityAgent with capabilities: [populate_attractions]
2025-10-13 06:30:19.187 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: bookingagent -> BookingAgent with capabilities: [book]
2025-10-13 06:30:19.187 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: costestimatoragent -> CostEstimatorAgent with capabilities: [estimate_costs]
2025-10-13 06:30:19.187 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: daybydayplanneragent -> DayByDayPlannerAgent with capabilities: [plan]
2025-10-13 06:30:19.188 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: editoragent -> EditorAgent with capabilities: [edit]
2025-10-13 06:30:19.188 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: enrichmentagent -> EnrichmentAgent with capabilities: [enrich]
2025-10-13 06:30:19.188 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: explainagent -> ExplainAgent with capabilities: [explain]
2025-10-13 06:30:19.188 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: mealagent -> MealAgent with capabilities: [populate_meals]
2025-10-13 06:30:19.189 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: placesagent -> PlacesAgent with capabilities: [search]
2025-10-13 06:30:19.189 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: planneragent -> PlannerAgent with capabilities: [create]
2025-10-13 06:30:19.189 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: skeletonplanneragent -> SkeletonPlannerAgent with capabilities: [skeleton]
2025-10-13 06:30:19.189 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: transportagent -> TransportAgent with capabilities: [populate_transport]
2025-10-13 06:30:19.190 [main] INFO  com.tripplanner.service.AgentRegistry - Total registered agents: 12
2025-10-13 06:30:19.191 [main] INFO  com.tripplanner.service.AgentRegistry - =====================================
2025-10-13 06:30:19.203 [main] INFO  com.tripplanner.service.AiClientLLMProvider - Initialized AiClientLLMProvider with AI client: ResilientAiClient [Provider: OpenRouter, Model: qwen/qwen-2.5-72b-instruct:free , Temperature: 0.70, Max Tokens: 8192, Model: gemini-2.5-flash, Temperature: 0.70, Max Tokens: 65535]
2025-10-13 06:30:19.205 [main] INFO  com.tripplanner.service.GeminiLLMProvider - Initialized GeminiLLMProvider with AI client: ResilientAiClient [Provider: OpenRouter, Model: qwen/qwen-2.5-72b-instruct:free , Temperature: 0.70, Max Tokens: 8192, Model: gemini-2.5-flash, Temperature: 0.70, Max Tokens: 65535]
2025-10-13 06:30:19.206 [main] INFO  com.tripplanner.service.LLMService - Registered LLM provider: ai-client
2025-10-13 06:30:19.208 [main] INFO  com.tripplanner.service.LLMService - Registered LLM provider: gemini
2025-10-13 06:30:19.209 [main] INFO  com.tripplanner.service.LLMService - LLMService initialized with 2 providers
2025-10-13 06:30:19.268 [main] INFO  com.tripplanner.config.WebSocketConfig - === WEBSOCKET CONFIG: CREATING DEDICATED TASK EXECUTOR ===
2025-10-13 06:30:19.271 [main] INFO  com.tripplanner.config.WebSocketConfig - WebSocket TaskExecutor configured:
2025-10-13 06:30:19.271 [main] INFO  com.tripplanner.config.WebSocketConfig -   Core Pool Size: 2
2025-10-13 06:30:19.271 [main] INFO  com.tripplanner.config.WebSocketConfig -   Max Pool Size: 10
2025-10-13 06:30:19.273 [main] INFO  com.tripplanner.config.WebSocketConfig -   Queue Capacity: 50
2025-10-13 06:30:19.273 [main] INFO  com.tripplanner.config.WebSocketConfig -   Thread Name Prefix: WebSocket-
2025-10-13 06:30:19.297 [main] INFO  com.tripplanner.config.WebSocketConfig - === WEBSOCKET CONFIG: CONFIGURING MESSAGE BROKER ===
2025-10-13 06:30:19.299 [main] INFO  com.tripplanner.config.WebSocketConfig - Message broker configured successfully
2025-10-13 06:30:19.408 [main] INFO  com.tripplanner.service.TaskLifecycleManager - Initializing Task Lifecycle Manager
2025-10-13 06:30:22.963 [main] INFO  com.tripplanner.service.TaskLifecycleManager - Started monitoring 0 existing running tasks
2025-10-13 06:30:22.963 [main] INFO  com.tripplanner.service.TaskLifecycleManager - Task Lifecycle Manager initialized
2025-10-13 06:30:22.984 [main] INFO  com.tripplanner.config.AsyncConfig - === ASYNC CONFIG: CREATING PRIMARY TASK EXECUTOR ===
2025-10-13 06:30:22.985 [main] INFO  com.tripplanner.config.AsyncConfig - Primary TaskExecutor configured:
2025-10-13 06:30:22.985 [main] INFO  com.tripplanner.config.AsyncConfig -   Core Pool Size: 5
2025-10-13 06:30:22.985 [main] INFO  com.tripplanner.config.AsyncConfig -   Max Pool Size: 20
2025-10-13 06:30:22.986 [main] INFO  com.tripplanner.config.AsyncConfig -   Queue Capacity: 100
2025-10-13 06:30:22.986 [main] INFO  com.tripplanner.config.AsyncConfig -   Thread Name Prefix: AsyncTask-
2025-10-13 06:30:22.986 [main] INFO  com.tripplanner.config.AsyncConfig -   Keep Alive Seconds: 60
2025-10-13 06:30:23.199 [main] INFO  com.tripplanner.config.WebSocketConfig - === WEBSOCKET CONFIG: REGISTERING STOMP ENDPOINTS ===
2025-10-13 06:30:23.209 [main] INFO  com.tripplanner.config.WebSocketConfig - STOMP endpoints registered successfully
2025-10-13 06:30:23.278 [main] DEBUG o.s.w.s.server.support.WebSocketHandlerMapping - Patterns [/ws/**] in 'stompWebSocketHandlerMapping'
2025-10-13 06:30:23.515 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 45 mappings in 'requestMappingHandlerMapping'
2025-10-13 06:30:23.604 [main] DEBUG o.s.web.servlet.handler.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-13 06:30:23.668 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name inMemoryUserDetailsManager
2025-10-13 06:30:23.906 [main] DEBUG o.s.security.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-10-13 06:30:23.995 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.AgentController:
	
2025-10-13 06:30:23.996 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.ChatController:
	
2025-10-13 06:30:23.997 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.DocumentationController:
	
2025-10-13 06:30:23.998 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.HealthController:
	
2025-10-13 06:30:23.998 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.ItinerariesController:
	
2025-10-13 06:30:23.998 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.PingController:
	
2025-10-13 06:30:23.998 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.ToolsController:
	
2025-10-13 06:30:24.005 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.WebSocketController:
	{[MESSAGE],[/itinerary/{itineraryId}]}: handleItineraryUpdate(String,Map)
	{[SUBSCRIBE],[/topic/itinerary/{itineraryId}]}: handleSubscription(String)
	{[MESSAGE],[/chat]}: handleChatMessage(Map)
2025-10-13 06:30:24.006 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-10-13 06:30:24.117 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-13 06:30:24.204 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-13 06:30:24.434 [main] DEBUG org.springframework.web.SimpLogging - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-10-13 06:30:24.434 [main] DEBUG org.springframework.web.SimpLogging - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-10-13 06:30:24.435 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Starting...
2025-10-13 06:30:24.435 [main] DEBUG org.springframework.web.SimpLogging - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@3023f157]
2025-10-13 06:30:24.435 [main] DEBUG org.springframework.web.SimpLogging - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@3023f157]
2025-10-13 06:30:24.436 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@3023f157]]
2025-10-13 06:30:24.438 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Started.
2025-10-13 06:30:24.439 [main] DEBUG org.springframework.web.SimpLogging - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-10-13 06:30:24.439 [main] DEBUG org.springframework.web.SimpLogging - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-10-13 06:30:24.465 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-10-13 06:30:24.481 [main] INFO  com.tripplanner.App - Started App in 13.428 seconds (process running for 14.14)
2025-10-13 06:30:43.372 [http-nio-8080-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-13 06:30:43.372 [http-nio-8080-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-10-13 06:30:43.373 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-10-13 06:30:43.373 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-10-13 06:30:43.373 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-10-13 06:30:43.375 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@6f430ea8
2025-10-13 06:30:43.375 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@5305f936
2025-10-13 06:30:43.375 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-10-13 06:30:43.375 [http-nio-8080-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 3 ms
2025-10-13 06:30:43.412 [http-nio-8080-exec-1] DEBUG org.springframework.security.web.FilterChainProxy - Securing OPTIONS /api/v1/itineraries
2025-10-13 06:30:43.490 [http-nio-8080-exec-2] DEBUG org.springframework.security.web.FilterChainProxy - Securing GET /api/v1/itineraries
2025-10-13 06:30:43.497 [http-nio-8080-exec-2] DEBUG org.springframework.security.web.FilterChainProxy - Secured GET /api/v1/itineraries
2025-10-13 06:30:43.502 [http-nio-8080-exec-2] DEBUG org.springframework.web.servlet.DispatcherServlet - GET "/api/v1/itineraries", parameters={}
2025-10-13 06:30:43.507 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.tripplanner.controller.ItinerariesController#getAll(HttpServletRequest)
2025-10-13 06:30:43.540 [http-nio-8080-exec-2] INFO  com.tripplanner.controller.ItinerariesController - Getting all itineraries
2025-10-13 06:30:43.540 [http-nio-8080-exec-2] WARN  com.tripplanner.controller.ItinerariesController - User ID not found in request, using anonymous for development
2025-10-13 06:30:43.540 [http-nio-8080-exec-2] INFO  com.tripplanner.service.UserDataService - Fetching trip metadata for user: anonymous
2025-10-13 06:30:44.185 [http-nio-8080-exec-2] INFO  com.tripplanner.service.UserDataService - Found 6 trip metadata entries for user: anonymous
2025-10-13 06:30:44.189 [http-nio-8080-exec-2] INFO  com.tripplanner.controller.ItinerariesController - Found 6 itineraries for user: anonymous
2025-10-13 06:30:44.255 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.annotation.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-13 06:30:44.276 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.annotation.HttpEntityMethodProcessor - Writing [[ItineraryDto(id=it_105ebb3d-b1a7-491c-a811-1af7fff0ecf1, destination=Almaty, Kazakhstan, startDate= (truncated)...]
2025-10-13 06:30:44.338 [http-nio-8080-exec-2] DEBUG org.springframework.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-13 06:30:44.341 [http-nio-8080-exec-2] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-10-13 06:30:51.256 [http-nio-8080-exec-3] DEBUG org.springframework.security.web.FilterChainProxy - Securing GET /api/v1/itineraries
2025-10-13 06:30:51.262 [http-nio-8080-exec-3] DEBUG org.springframework.security.web.FilterChainProxy - Secured GET /api/v1/itineraries
2025-10-13 06:30:51.263 [http-nio-8080-exec-3] DEBUG org.springframework.web.servlet.DispatcherServlet - GET "/api/v1/itineraries", parameters={}
2025-10-13 06:30:51.266 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.tripplanner.controller.ItinerariesController#getAll(HttpServletRequest)
2025-10-13 06:30:51.268 [http-nio-8080-exec-3] INFO  com.tripplanner.controller.ItinerariesController - Getting all itineraries
2025-10-13 06:30:51.269 [http-nio-8080-exec-3] WARN  com.tripplanner.controller.ItinerariesController - User ID not found in request, using anonymous for development
2025-10-13 06:30:51.270 [http-nio-8080-exec-3] INFO  com.tripplanner.service.UserDataService - Fetching trip metadata for user: anonymous
2025-10-13 06:30:51.698 [http-nio-8080-exec-3] INFO  com.tripplanner.service.UserDataService - Found 6 trip metadata entries for user: anonymous
2025-10-13 06:30:51.709 [http-nio-8080-exec-3] INFO  com.tripplanner.controller.ItinerariesController - Found 6 itineraries for user: anonymous
2025-10-13 06:30:51.717 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.annotation.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-13 06:30:51.724 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.annotation.HttpEntityMethodProcessor - Writing [[ItineraryDto(id=it_105ebb3d-b1a7-491c-a811-1af7fff0ecf1, destination=Almaty, Kazakhstan, startDate= (truncated)...]
2025-10-13 06:30:51.735 [http-nio-8080-exec-3] DEBUG org.springframework.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-13 06:30:51.737 [http-nio-8080-exec-3] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-10-13 06:31:24.463 [MessageBroker-1] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-10-13 06:31:27.320 [http-nio-8080-exec-4] DEBUG org.springframework.security.web.FilterChainProxy - Securing GET /api/v1/itineraries
2025-10-13 06:31:27.323 [http-nio-8080-exec-4] DEBUG org.springframework.security.web.FilterChainProxy - Secured GET /api/v1/itineraries
2025-10-13 06:31:27.323 [http-nio-8080-exec-4] DEBUG org.springframework.web.servlet.DispatcherServlet - GET "/api/v1/itineraries", parameters={}
2025-10-13 06:31:27.323 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.tripplanner.controller.ItinerariesController#getAll(HttpServletRequest)
2025-10-13 06:31:27.324 [http-nio-8080-exec-4] INFO  com.tripplanner.controller.ItinerariesController - Getting all itineraries
2025-10-13 06:31:27.324 [http-nio-8080-exec-4] WARN  com.tripplanner.controller.ItinerariesController - User ID not found in request, using anonymous for development
2025-10-13 06:31:27.324 [http-nio-8080-exec-4] INFO  com.tripplanner.service.UserDataService - Fetching trip metadata for user: anonymous
2025-10-13 06:31:27.755 [http-nio-8080-exec-4] INFO  com.tripplanner.service.UserDataService - Found 6 trip metadata entries for user: anonymous
2025-10-13 06:31:27.757 [http-nio-8080-exec-4] INFO  com.tripplanner.controller.ItinerariesController - Found 6 itineraries for user: anonymous
2025-10-13 06:31:27.759 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.annotation.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-13 06:31:27.761 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.annotation.HttpEntityMethodProcessor - Writing [[ItineraryDto(id=it_105ebb3d-b1a7-491c-a811-1af7fff0ecf1, destination=Almaty, Kazakhstan, startDate= (truncated)...]
2025-10-13 06:31:27.769 [http-nio-8080-exec-4] DEBUG org.springframework.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-13 06:31:27.770 [http-nio-8080-exec-4] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-10-13 06:36:37.421 [main] INFO  com.tripplanner.App - Starting App using Java 17.0.15 with PID 16484 (C:\Users\rites\Documents\AgenticItineraryPlanner\build\classes\java\main started by rites in C:\Users\rites\Documents\AgenticItineraryPlanner)
2025-10-13 06:36:37.424 [main] INFO  com.tripplanner.App - No active profile set, falling back to 1 default profile: "default"
2025-10-13 06:36:40.490 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-13 06:36:40.505 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-10-13 06:36:40.506 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-10-13 06:36:40.658 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-13 06:36:40.658 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 3139 ms
2025-10-13 06:36:40.823 [main] INFO  com.tripplanner.config.FirestoreConfig - Firebase initialized for project: tripaiplanner-4c951
2025-10-13 06:36:40.957 [main] DEBUG o.springframework.web.filter.ForwardedHeaderFilter - Filter 'forwardedHeaderFilter' configured for use
2025-10-13 06:36:40.987 [main] INFO  com.tripplanner.config.AiClientConfig - === AI CLIENT CONFIGURATION ===
2025-10-13 06:36:40.987 [main] INFO  com.tripplanner.config.AiClientConfig - AI provider: openrouter
2025-10-13 06:36:40.987 [main] INFO  com.tripplanner.config.AiClientConfig - OpenRouter API key configured: false
2025-10-13 06:36:40.987 [main] INFO  com.tripplanner.config.AiClientConfig - Gemini API key configured: false
2025-10-13 06:36:41.223 [main] INFO  c.tripplanner.service.openrouter.OpenRouterClient - Initialized OpenRouter client with model: qwen/qwen-2.5-72b-instruct:free  | apiKey=MISSING
2025-10-13 06:36:41.230 [main] INFO  com.tripplanner.service.GeminiClient - Initializing Gemini client with model: gemini-2.5-flash
2025-10-13 06:36:41.233 [main] INFO  com.tripplanner.service.GeminiClient - Gemini client initialized successfully with 150s request timeout
2025-10-13 06:36:41.234 [main] INFO  com.tripplanner.config.AiClientConfig - OpenRouter client available: false
2025-10-13 06:36:41.235 [main] INFO  com.tripplanner.config.AiClientConfig - Gemini client available: true
2025-10-13 06:36:41.235 [main] INFO  com.tripplanner.config.AiClientConfig - Creating ResilientAiClient with OpenRouter as primary, Gemini as fallback
2025-10-13 06:36:41.235 [main] INFO  com.tripplanner.config.AiClientConfig - Creating ResilientAiClient with 2 providers
2025-10-13 06:36:41.238 [main] INFO  com.tripplanner.service.ai.ResilientAiClient - ResilientAiClient initialized with 2 providers
2025-10-13 06:36:41.238 [main] INFO  com.tripplanner.service.ai.ResilientAiClient -   Provider 1: OpenRouterClient (available: false)
2025-10-13 06:36:41.239 [main] INFO  com.tripplanner.service.ai.ResilientAiClient -   Provider 2: GeminiClient (available: true)
2025-10-13 06:36:41.239 [main] INFO  com.tripplanner.config.AiClientConfig - ResilientAiClient created successfully
2025-10-13 06:36:41.380 [main] INFO  com.tripplanner.config.FirestoreConfig - Firestore project ID set to: tripaiplanner-4c951
2025-10-13 06:36:41.382 [main] INFO  com.tripplanner.config.FirestoreConfig - Configured Firestore credentials from firestore_credentials.json
2025-10-13 06:36:43.161 [main] INFO  com.tripplanner.config.FirestoreConfig - Firestore initialized for project: tripaiplanner-4c951 (emulator: false)
2025-10-13 06:36:43.435 [main] INFO  com.tripplanner.service.AgentRegistry - === AGENT REGISTRY INITIALIZATION ===
2025-10-13 06:36:43.435 [main] INFO  com.tripplanner.service.AgentRegistry - Found 12 agents to register
2025-10-13 06:36:43.437 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: activityagent -> ActivityAgent with capabilities: [populate_attractions]
2025-10-13 06:36:43.437 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: bookingagent -> BookingAgent with capabilities: [book]
2025-10-13 06:36:43.437 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: costestimatoragent -> CostEstimatorAgent with capabilities: [estimate_costs]
2025-10-13 06:36:43.438 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: daybydayplanneragent -> DayByDayPlannerAgent with capabilities: [plan]
2025-10-13 06:36:43.438 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: editoragent -> EditorAgent with capabilities: [edit]
2025-10-13 06:36:43.438 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: enrichmentagent -> EnrichmentAgent with capabilities: [enrich]
2025-10-13 06:36:43.438 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: explainagent -> ExplainAgent with capabilities: [explain]
2025-10-13 06:36:43.438 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: mealagent -> MealAgent with capabilities: [populate_meals]
2025-10-13 06:36:43.439 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: placesagent -> PlacesAgent with capabilities: [search]
2025-10-13 06:36:43.439 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: planneragent -> PlannerAgent with capabilities: [create]
2025-10-13 06:36:43.439 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: skeletonplanneragent -> SkeletonPlannerAgent with capabilities: [skeleton]
2025-10-13 06:36:43.439 [main] INFO  com.tripplanner.service.AgentRegistry - Registered agent: transportagent -> TransportAgent with capabilities: [populate_transport]
2025-10-13 06:36:43.439 [main] INFO  com.tripplanner.service.AgentRegistry - Total registered agents: 12
2025-10-13 06:36:43.439 [main] INFO  com.tripplanner.service.AgentRegistry - =====================================
2025-10-13 06:36:43.452 [main] INFO  com.tripplanner.service.AiClientLLMProvider - Initialized AiClientLLMProvider with AI client: ResilientAiClient [Provider: OpenRouter, Model: qwen/qwen-2.5-72b-instruct:free , Temperature: 0.70, Max Tokens: 8192, Model: gemini-2.5-flash, Temperature: 0.70, Max Tokens: 65535]
2025-10-13 06:36:43.453 [main] INFO  com.tripplanner.service.GeminiLLMProvider - Initialized GeminiLLMProvider with AI client: ResilientAiClient [Provider: OpenRouter, Model: qwen/qwen-2.5-72b-instruct:free , Temperature: 0.70, Max Tokens: 8192, Model: gemini-2.5-flash, Temperature: 0.70, Max Tokens: 65535]
2025-10-13 06:36:43.454 [main] INFO  com.tripplanner.service.LLMService - Registered LLM provider: ai-client
2025-10-13 06:36:43.455 [main] INFO  com.tripplanner.service.LLMService - Registered LLM provider: gemini
2025-10-13 06:36:43.455 [main] INFO  com.tripplanner.service.LLMService - LLMService initialized with 2 providers
2025-10-13 06:36:43.494 [main] INFO  com.tripplanner.config.WebSocketConfig - === WEBSOCKET CONFIG: CREATING DEDICATED TASK EXECUTOR ===
2025-10-13 06:36:43.498 [main] INFO  com.tripplanner.config.WebSocketConfig - WebSocket TaskExecutor configured:
2025-10-13 06:36:43.499 [main] INFO  com.tripplanner.config.WebSocketConfig -   Core Pool Size: 2
2025-10-13 06:36:43.499 [main] INFO  com.tripplanner.config.WebSocketConfig -   Max Pool Size: 10
2025-10-13 06:36:43.499 [main] INFO  com.tripplanner.config.WebSocketConfig -   Queue Capacity: 50
2025-10-13 06:36:43.499 [main] INFO  com.tripplanner.config.WebSocketConfig -   Thread Name Prefix: WebSocket-
2025-10-13 06:36:43.523 [main] INFO  com.tripplanner.config.WebSocketConfig - === WEBSOCKET CONFIG: CONFIGURING MESSAGE BROKER ===
2025-10-13 06:36:43.526 [main] INFO  com.tripplanner.config.WebSocketConfig - Message broker configured successfully
2025-10-13 06:36:43.645 [main] INFO  com.tripplanner.service.TaskLifecycleManager - Initializing Task Lifecycle Manager
2025-10-13 06:36:46.909 [main] INFO  com.tripplanner.service.TaskLifecycleManager - Started monitoring 0 existing running tasks
2025-10-13 06:36:46.910 [main] INFO  com.tripplanner.service.TaskLifecycleManager - Task Lifecycle Manager initialized
2025-10-13 06:36:46.950 [main] INFO  com.tripplanner.config.AsyncConfig - === ASYNC CONFIG: CREATING PRIMARY TASK EXECUTOR ===
2025-10-13 06:36:46.950 [main] INFO  com.tripplanner.config.AsyncConfig - Primary TaskExecutor configured:
2025-10-13 06:36:46.951 [main] INFO  com.tripplanner.config.AsyncConfig -   Core Pool Size: 5
2025-10-13 06:36:46.951 [main] INFO  com.tripplanner.config.AsyncConfig -   Max Pool Size: 20
2025-10-13 06:36:46.951 [main] INFO  com.tripplanner.config.AsyncConfig -   Queue Capacity: 100
2025-10-13 06:36:46.951 [main] INFO  com.tripplanner.config.AsyncConfig -   Thread Name Prefix: AsyncTask-
2025-10-13 06:36:46.952 [main] INFO  com.tripplanner.config.AsyncConfig -   Keep Alive Seconds: 60
2025-10-13 06:36:47.166 [main] INFO  com.tripplanner.config.WebSocketConfig - === WEBSOCKET CONFIG: REGISTERING STOMP ENDPOINTS ===
2025-10-13 06:36:47.175 [main] INFO  com.tripplanner.config.WebSocketConfig - STOMP endpoints registered successfully
2025-10-13 06:36:47.272 [main] DEBUG o.s.w.s.server.support.WebSocketHandlerMapping - Patterns [/ws/**] in 'stompWebSocketHandlerMapping'
2025-10-13 06:36:47.537 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 45 mappings in 'requestMappingHandlerMapping'
2025-10-13 06:36:47.637 [main] DEBUG o.s.web.servlet.handler.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-13 06:36:47.698 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name inMemoryUserDetailsManager
2025-10-13 06:36:47.982 [main] DEBUG o.s.security.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-10-13 06:36:48.152 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.AgentController:
	
2025-10-13 06:36:48.153 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.ChatController:
	
2025-10-13 06:36:48.153 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.DocumentationController:
	
2025-10-13 06:36:48.154 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.HealthController:
	
2025-10-13 06:36:48.154 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.ItinerariesController:
	
2025-10-13 06:36:48.155 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.PingController:
	
2025-10-13 06:36:48.155 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.ToolsController:
	
2025-10-13 06:36:48.169 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.t.c.WebSocketController:
	{[MESSAGE],[/itinerary/{itineraryId}]}: handleItineraryUpdate(String,Map)
	{[SUBSCRIBE],[/topic/itinerary/{itineraryId}]}: handleSubscription(String)
	{[MESSAGE],[/chat]}: handleChatMessage(Map)
2025-10-13 06:36:48.172 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-10-13 06:36:48.354 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-13 06:36:48.472 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-13 06:36:48.760 [main] DEBUG org.springframework.web.SimpLogging - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-10-13 06:36:48.760 [main] DEBUG org.springframework.web.SimpLogging - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/app/]]
2025-10-13 06:36:48.762 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Starting...
2025-10-13 06:36:48.763 [main] DEBUG org.springframework.web.SimpLogging - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@58b5d5fc]
2025-10-13 06:36:48.763 [main] DEBUG org.springframework.web.SimpLogging - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@58b5d5fc]
2025-10-13 06:36:48.764 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@58b5d5fc]]
2025-10-13 06:36:48.766 [main] INFO  o.s.m.simp.broker.SimpleBrokerMessageHandler - Started.
2025-10-13 06:36:48.768 [main] DEBUG org.springframework.web.SimpLogging - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-10-13 06:36:48.768 [main] DEBUG org.springframework.web.SimpLogging - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-10-13 06:36:48.794 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-10-13 06:36:48.816 [main] INFO  com.tripplanner.App - Started App in 12.508 seconds (process running for 13.324)
2025-10-13 06:36:48.960 [http-nio-8080-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-13 06:36:48.960 [http-nio-8080-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-10-13 06:36:48.962 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-10-13 06:36:48.962 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-10-13 06:36:48.962 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-10-13 06:36:48.963 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@59b1edab
2025-10-13 06:36:48.964 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@3f033664
2025-10-13 06:36:48.965 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-10-13 06:36:48.965 [http-nio-8080-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 3 ms
2025-10-13 06:36:49.624 [http-nio-8080-exec-1] DEBUG org.springframework.security.web.FilterChainProxy - Securing GET /api/v1/itineraries
2025-10-13 06:36:49.706 [http-nio-8080-exec-1] DEBUG org.springframework.security.web.FilterChainProxy - Secured GET /api/v1/itineraries
2025-10-13 06:36:49.713 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - GET "/api/v1/itineraries", parameters={}
2025-10-13 06:36:49.719 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.tripplanner.controller.ItinerariesController#getAll(HttpServletRequest)
2025-10-13 06:36:49.762 [http-nio-8080-exec-1] INFO  com.tripplanner.controller.ItinerariesController - Getting all itineraries
2025-10-13 06:36:49.763 [http-nio-8080-exec-1] INFO  com.tripplanner.service.UserDataService - Fetching trip metadata for user: PEoULmiNa2dBOZrlBcXs8EZIkXs1
2025-10-13 06:36:50.244 [http-nio-8080-exec-1] INFO  com.tripplanner.service.UserDataService - Found 0 trip metadata entries for user: PEoULmiNa2dBOZrlBcXs8EZIkXs1
2025-10-13 06:36:50.246 [http-nio-8080-exec-1] INFO  com.tripplanner.controller.ItinerariesController - Found 0 itineraries for user: PEoULmiNa2dBOZrlBcXs8EZIkXs1
2025-10-13 06:36:50.327 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.annotation.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-13 06:36:50.331 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.annotation.HttpEntityMethodProcessor - Writing [[]]
2025-10-13 06:36:50.368 [http-nio-8080-exec-1] DEBUG org.springframework.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-13 06:36:50.371 [http-nio-8080-exec-1] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-10-13 06:37:40.672 [http-nio-8080-exec-2] DEBUG org.springframework.security.web.FilterChainProxy - Securing GET /api/v1/itineraries
2025-10-13 06:37:40.674 [http-nio-8080-exec-2] DEBUG org.springframework.security.web.FilterChainProxy - Secured GET /api/v1/itineraries
2025-10-13 06:37:40.675 [http-nio-8080-exec-2] DEBUG org.springframework.web.servlet.DispatcherServlet - GET "/api/v1/itineraries", parameters={}
2025-10-13 06:37:40.676 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.tripplanner.controller.ItinerariesController#getAll(HttpServletRequest)
2025-10-13 06:37:40.677 [http-nio-8080-exec-2] INFO  com.tripplanner.controller.ItinerariesController - Getting all itineraries
2025-10-13 06:37:40.677 [http-nio-8080-exec-2] INFO  com.tripplanner.service.UserDataService - Fetching trip metadata for user: PEoULmiNa2dBOZrlBcXs8EZIkXs1
2025-10-13 06:37:41.125 [http-nio-8080-exec-2] INFO  com.tripplanner.service.UserDataService - Found 0 trip metadata entries for user: PEoULmiNa2dBOZrlBcXs8EZIkXs1
2025-10-13 06:37:41.125 [http-nio-8080-exec-2] INFO  com.tripplanner.controller.ItinerariesController - Found 0 itineraries for user: PEoULmiNa2dBOZrlBcXs8EZIkXs1
2025-10-13 06:37:41.126 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.annotation.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-13 06:37:41.126 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.annotation.HttpEntityMethodProcessor - Writing [[]]
2025-10-13 06:37:41.128 [http-nio-8080-exec-2] DEBUG org.springframework.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-13 06:37:41.128 [http-nio-8080-exec-2] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-10-13 06:37:48.776 [MessageBroker-1] INFO  o.s.web.socket.config.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
